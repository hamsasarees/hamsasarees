<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Hamsa Sarees</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
<link rel="icon" href="hamsasareeslogo.jpg" type="image/jpeg">
  
 
<style>
/* ================= ROOT THEME ================= */
:root{
  --bg-main:#0a0e1a;
  --bg-panel:#11172c;
  --bg-soft:#161e3d;
  --glass: rgba(255, 255, 255, 0.03);
  --border:rgba(255,255,255,0.08);

  --gold:#e6b566;
  --gold-dark:#cfa34e;

  --text-main:#eef2ff;
  --text-muted:#9fb0d1;

  --success:#3ddc97;
  --danger:#ff6b6b;
}

/* ================= RESET ================= */
*{box-sizing:border-box}

html,body{
  margin:0;
  font-family:Inter,system-ui,Arial,sans-serif;
  background:
    radial-gradient(circle at 50% 0%, #1a2342 0%, transparent 70%),
    radial-gradient(circle at 85% 30%, rgba(230, 181, 102, 0.08) 0%, transparent 50%),
    #0a0e1a;
  color:var(--text-main);
  scroll-behavior: smooth !important;
}
/* ================= SCROLLBAR ================= */
::-webkit-scrollbar { width: 8px; height: 8px; }
::-webkit-scrollbar-track { background: var(--bg-main); }
::-webkit-scrollbar-thumb { background: var(--border); border-radius: 4px; }
::-webkit-scrollbar-thumb:hover { background: var(--gold); }

/* ================= SELECTION ================= */
::selection { background: var(--gold); color: #0a0e1a; }
::-moz-selection { background: var(--gold); color: #0a0e1a; }
::placeholder { color: var(--text-muted); opacity: 0.6; }
*:focus { outline: none !important; }

/* ================= ANNOUNCEMENT BAR ================= */
.announcement-bar {
  background: linear-gradient(90deg, #0f1738, #161e3d);
  color: var(--gold);
  text-align: center;
  padding: 8px;
  font-size: 12px;
  font-weight: 600;
  border-bottom: 1px solid var(--border);
  letter-spacing: 0.5px;
}
.announcement-bar p { margin: 0; animation: pulse-text 3s infinite; }
@keyframes pulse-text { 0%, 100% { opacity: 1; } 50% { opacity: 0.8; } }

/* ================= FLOATING CART ================= */
.floating-cart {
  position: fixed; bottom: 30px; right: 30px;
  width: 60px; height: 60px;
  background: var(--bg-panel); border: 1px solid var(--gold);
  border-radius: 50%; display: flex; align-items: center; justify-content: center;
  box-shadow: 0 10px 30px rgba(0,0,0,0.5); z-index: 900;
  cursor: pointer; transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  color: var(--gold);
}
.floating-cart:hover { transform: scale(1.1) rotate(5deg); box-shadow: 0 15px 40px rgba(230, 181, 102, 0.2); }
.floating-cart-count {
  position: absolute; top: 0; right: 0;
  background: var(--danger); color: white;
  font-size: 11px; font-weight: 800;
  width: 22px; height: 22px; border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  border: 2px solid var(--bg-main);
}

/* ================= FILTERS ================= */
.filter-section{
  background: rgba(255, 255, 255, 0.02);
  backdrop-filter: blur(12px);
  border:1px solid rgba(255,255,255,0.05);
  padding:30px; /* 6ï¸âƒ£ SMART EMPTY SPACE */
  border-radius:20px;
  margin-top:30px;
  box-shadow: 0 20px 40px rgba(0,0,0,0.1);
}
.color-filter-grid{
  display:flex; flex-wrap:wrap; gap:12px;
}
.color-filter-item, .filter-item { 
  display:flex; align-items:center; gap:6px; 
  background:rgba(255,255,255,0.03); 
  padding:8px 14px; 
  border-radius:50px; /* Pill shape */
  font-size:13px; 
  cursor:pointer; 
  border:1px solid var(--border); 
  transition: all 0.2s ease;
}
.color-filter-item:hover, .filter-item:hover { background: rgba(255,255,255,0.08); transform: translateY(-1px); }

.color-swatch{ width:16px; height:16px; border-radius:50%; border:1px solid rgba(255,255,255,0.1); }
/* ================= LAYOUT ================= */
.container{
  position: relative;
  z-index: 1;
  max-width:1200px;
  margin:auto;
  padding:20px 16px;
}

/* ================= HEADER ================= */
header{
  display:flex;
  align-items:center;
  gap:18px;
  padding:16px 18px;
  border-radius:16px;
  background: rgba(255, 255, 255, 0.03);
  backdrop-filter: blur(12px);
  border:1px solid rgba(255,255,255,0.05);
  box-shadow:0 20px 50px rgba(0,0,0,0.3);
  position: relative;
}
.brand{
  display:flex;
  gap:14px;
  align-items:center;
}

.logo{
  width:52px;
  height:52px;
  border-radius:14px;
  overflow:hidden;
  transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
  border: 1px solid rgba(255,255,255,0.1);
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
  flex-shrink: 0;
}

.logo img {
  width: 100%;
  height: 100%;
  object-fit: cover; /* Ensures the image fills the container */
}
.logo:hover { transform: scale(1.05); box-shadow: 0 8px 20px rgba(230, 181, 102, 0.2); border-color: var(--gold); }

.title{
  font-weight:800;
  letter-spacing: -0.01em;
  font-size:18px;
  line-height: 1.2;
  background: linear-gradient(90deg, #fff, #e6b566);
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
}

.small{
  font-size:13px;
  color:var(--text-muted);
}

/* ================= SEARCH ================= */
.search{
  display:flex;
  align-items:center;
  gap:10px;
  background: rgba(255, 255, 255, 0.03);
  border:1px solid rgba(255,255,255,0.1);
  padding:10px 14px;
  border-radius:14px;
  max-width:420px;
  width:100%;
  transition: box-shadow 0.3s ease, border-color 0.3s ease, transform 0.3s ease;
}
.search:focus-within {
  border-color: var(--gold);
  transform: scale(1.02);
  background: rgba(255, 255, 255, 0.05);
  box-shadow: 0 0 0 2px var(--bg-main), 0 0 0 4px var(--gold);
}

.search input{
  flex:1;
  background:none;
  border:none;
  outline:none;
  color:var(--text-main);
  font-size:14px;
}
.search-clear {
  background: none; border: none; color: var(--text-muted);
  cursor: pointer; padding: 0 4px; display: none;
  font-size: 16px; transition: color 0.2s;
}
.search-clear:hover { color: var(--text-main); }

/* ================= BUTTONS ================= */
button,a{
  font-family:inherit;
}

.btn{
  background:linear-gradient(135deg,var(--gold),#cfa34e,var(--gold));
  background-size: 200% 100%;
  color:#3b2b08;
  border:none;
  padding:10px 18px;
  border-radius:14px;
  font-weight:800;
  cursor:pointer;
  text-decoration: none;
  transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.3s cubic-bezier(0.4, 0, 0.2, 1), background 0.3s ease;
  transition-delay: 20ms;
  box-shadow:0 4px 10px rgba(230,181,102,0.2);
  position: relative;
  overflow: hidden;
}

.btn::after {
  content: '';
  position: absolute;
  top: 0; left: -100%; width: 100%; height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
  transition: 0.6s ease-in-out;
}
.btn-icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}
.btn:hover::after {
  left: 100%;
}
.btn:active {
  transform: scale(0.96);
}

button:disabled, .btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
  filter: grayscale(0.8);
  box-shadow: none;
  transform: none !important;
}

input:focus, textarea:focus, select:focus {
  border-color: var(--gold);
  outline: none;
  box-shadow: 0 0 0 2px var(--bg-main), 0 0 0 4px rgba(230,181,102,0.6);
  transition: box-shadow 0.2s ease, border-color 0.2s ease;
}

input.invalid, textarea.invalid {
  border-color: var(--danger);
}

.error-message {
  font-size: 12px;
  color: var(--danger);
  min-height: 16px;
  margin-top: 4px;
}

.btn:hover{
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(230, 181, 102, 0.3);
  background-position: 100% 0;
}

.btn-ghost{
  background:#0f1738;
  border:1px solid var(--border);
  color:var(--text-main);
  padding:9px 16px;
  border-radius:14px;
  cursor:pointer;
  transition: transform 0.3s cubic-bezier(0.25, 0.8, 0.25, 1), background 0.3s ease, box-shadow 0.3s ease;
  transition-delay: 20ms;
}

.btn-ghost:hover{
  background:#18225a;
  transform: translateY(-2px);
  box-shadow: 0 8px 20px rgba(0,0,0,0.3);
}
.btn-ghost:active {
  transform: scale(0.96);
}

/* ================= HERO ================= */
.hero{
  display:flex;
  justify-content: center;
  margin-top:40px; /* 6ï¸âƒ£ SMART EMPTY SPACE */
  margin-bottom: 40px;
}

.hero-card {
  width: 100%;
  background: radial-gradient(circle at top right, rgba(230, 181, 102, 0.08), transparent 40%), linear-gradient(135deg, #1a2342 0%, #050810 100%);
  border:1px solid rgba(230, 181, 102, 0.15);
  border-radius:20px;
  padding:60px 20px;
  box-shadow:0 40px 100px -20px rgba(0,0,0,0.7), inset 0 0 0 1px rgba(255,255,255,0.05);
  text-align: center;
  position: relative;
  overflow: hidden;
  backdrop-filter: blur(10px);
  animation: floatHero 6s ease-in-out infinite;
}
@keyframes floatHero { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

/* Subtle animated background for hero */
.hero-card::before {
  content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
  background: radial-gradient(circle, rgba(230, 181, 102, 0.05) 0%, transparent 60%);
  animation: rotateHero 20s linear infinite; pointer-events: none;
}
@keyframes rotateHero { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

.hero-content { position: relative; z-index: 2; max-width: 700px; margin: 0 auto; }

.hero-content h1 {
  font-size: 3.5rem; margin: 10px 0; letter-spacing: -0.03em;
  background: linear-gradient(90deg, #fff, #e6b566, #fff); background-size: 200%;
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  animation: shineText 4s linear infinite;
}
@keyframes shineText { to { background-position: 200%; } }

.hero-desc { font-size: 1.1rem; color: var(--text-muted); margin-bottom: 24px; line-height: 1.6; }
.badge-pill { display: inline-block; background: rgba(230, 181, 102, 0.15); color: var(--gold); padding: 6px 16px; border-radius: 50px; font-size: 12px; font-weight: 700; letter-spacing: 1px; text-transform: uppercase; margin-bottom: 12px; border: 1px solid rgba(230, 181, 102, 0.3); }
.hero-address {
  display: inline-flex; align-items: center; justify-content: center; gap: 10px;
  background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1);
  padding: 10px 20px; border-radius: 50px;
  font-size: 14px; color: var(--text-muted);
  margin-bottom: 24px; transition: all 0.3s ease; backdrop-filter: blur(4px);
}
.hero-address:hover {
  background: rgba(255,255,255,0.08); border-color: var(--gold);
  color: var(--text-main); transform: translateY(-2px); box-shadow: 0 10px 20px rgba(0,0,0,0.2);
}

@media(max-width:768px){
  .hero-card { padding: 40px 16px; }
  .hero-content h1 { font-size: 2rem; }
}

/* ================= PRODUCT GRID ================= */
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
  gap:18px;
  margin-top:18px;
}

/* ================= PRODUCT CARD ================= */
.card{
  background: rgba(255, 255, 255, 0.02);
  backdrop-filter: blur(10px);
  border:1px solid rgba(255,255,255,0.05);
  border-radius:18px;
  padding:12px;
  cursor:default; /* 1ï¸âƒ£ SUBTLE HOVER "LIFE" */
  transition: transform 0.4s cubic-bezier(0.25, 0.8, 0.25, 1), background 0.3s ease, box-shadow 0.4s ease, border-color 0.3s ease;
  box-shadow:0 10px 30px rgba(0,0,0,0.15);
  display: flex;
  flex-direction: column;
  height: 100%;
  will-change: transform;
  contain: layout paint;
  position: relative;
}
@keyframes fadeIn { from { opacity:0; transform:translateY(20px); } to { opacity:1; transform:translateY(0); } }

.card:hover{
  transform: translateY(-5px);
  background: rgba(255, 255, 255, 0.06);
  box-shadow: 0 15px 35px rgba(0,0,0,0.25), inset 0 0 0 1px rgba(255,255,255,0.05);
  border-color: rgba(230, 181, 102, 0.5);
}

/* 2ï¸âƒ£ QUICK ACTIONS ON PRODUCT CARDS */
.card-actions {
  position: absolute; top: 12px; right: 12px;
  display: flex; flex-direction: column; gap: 8px;
  opacity: 0; transform: translateX(10px);
  transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1); z-index: 5;
}
.card:hover .card-actions { opacity: 1; transform: translateX(0); }
.action-btn {
  width: 36px; height: 36px; border-radius: 50%;
  background: rgba(15, 23, 56, 0.8); backdrop-filter: blur(8px);
  border: 1px solid rgba(255,255,255,0.1); color: var(--text-main);
  display: flex; align-items: center; justify-content: center;
  cursor: pointer; transition: all 0.2s;
}
.wishlist-btn.active {
  background: rgba(255, 107, 107, 0.2);
  color: var(--danger);
  border-color: var(--danger);
}
.wishlist-btn.active svg { fill: var(--danger); }
.action-btn:hover { background: var(--gold); color: #000; border-color: var(--gold); transform: scale(1.1); }

/* Hover Overlay for Image */
.card .imgwrap::after {
  content: 'View Details';
  position: absolute;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%) scale(0.9);
  background: rgba(10, 14, 26, 0.8);
  padding: 10px 20px;
  border-radius: 30px;
  border: 1px solid var(--gold);
  display: flex; align-items: center; justify-content: center;
  color: var(--gold); font-weight: 700; opacity: 0; transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
  backdrop-filter: blur(4px);
  white-space: nowrap;
  z-index: 3;
}
.card:hover .imgwrap::after {
  opacity: 1;
  transform: translate(-50%, -50%) scale(1);
}

.card.out-of-stock {
  opacity: 0.75;
}

.card.out-of-stock .imgwrap {
  filter: grayscale(0.6);
}
.card.out-of-stock .imgwrap::before {
  content: 'SOLD OUT';
  position: absolute;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%) rotate(-15deg);
  background: rgba(255, 107, 107, 0.85);
  color: white;
  padding: 8px 20px;
  font-weight: 800;
  z-index: 10;
  border-radius: 8px;
  pointer-events: none;
  box-shadow: 0 4px 15px rgba(0,0,0,0.3);
}

/* IMAGE */
.imgwrap{
  width:100%;
  aspect-ratio:3/4;
  border-radius:14px;
  overflow:hidden;
  background:#080c1f;
  position:relative;
  cursor: pointer;
}
img { background: #0b1020; }
img:not([src]) { visibility: hidden; }

.imgwrap img{
  width:100%;
  height:100%;
  object-fit:cover;
  transition:transform .4s ease;
}
.imgwrap img.secondary-img {
  position: absolute; top: 0; left: 0; opacity: 0; z-index: 2;
  transition: opacity 0.4s ease;
}

.card:hover .imgwrap img{
  transform:scale(1.05);
}
/* Show secondary image on hover */
.card:hover .imgwrap img.secondary-img {
  opacity: 1;
}

/* TEXT */
.card h3{
  margin:12px 0 6px;
  font-size:15px;
  font-weight:500;
  letter-spacing: -0.01em;
  line-height: 1.5;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
  color: var(--text-main);
  cursor: pointer;
}

/* ================= PRICE ================= */
.price-wrap{
  display:flex;
  align-items:baseline;
  gap:8px;
}

.price-old{
  font-size:13px;
  color:var(--text-muted);
  text-decoration:line-through;
}

.price-new{
  font-size:18px;
  font-weight:900;
  letter-spacing: 0.5px;
  color:var(--gold);
}

.discount-badge{
  margin-left:auto;
  font-size:12px;
  font-weight:800;
  background:#7ee0b2;
  color:#0a0e1a;
  padding:4px 10px;
  border-radius:999px;
}

/* ================= RATING ================= */
.product-rating{
  font-size:12px;
  opacity: 0.7;
  color:var(--success);
}
h2 {
  background: linear-gradient(90deg, #fff, #e6b566);
  letter-spacing: -0.02em;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

/* ================= MODALS ================= */
.modal{
  position:fixed;
  inset:0;
  background:rgba(5, 8, 15, 0.85);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:1000;
}

#zoomModal {
  z-index: 1100;
}

.modal.show{display:flex}

.modal-box{
  background: rgba(22, 32, 81, 0.95);
  backdrop-filter: blur(16px);
  border:1px solid var(--border);
  border-radius:20px;
  padding:24px;
  max-width:900px;
  width:100%;
  max-height:90vh;
  overflow:auto;
  box-shadow:0 40px 120px rgba(0,0,0,.7);
  animation: modalPop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}
@keyframes modalPop { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }

/* CLOSE BUTTON */
.close-x{
  float:right;
  background:none;
  border:none;
  color:var(--text-muted);
  font-size:24px;
  cursor:pointer;
  width: 44px;
  height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  transition: background 0.2s ease, color 0.2s ease;
}
.close-x:hover { background: rgba(255,255,255,0.1); color: var(--text-main); }

/* ================= PRODUCT DETAIL ================= */
.product-detail-box{max-width:1000px}

.pd-layout{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:30px;
}

.pd-main-img{
  width:100%;
  border-radius:16px;
}

.pd-thumbs{
  display:flex;
  gap:8px;
  margin-top:10px;
}

.pd-thumbs img{
  width:64px;
  height:86px;
  object-fit:cover;
  border-radius:10px;
  opacity:.6;
  cursor:pointer;
}

.pd-thumbs img.active{
  opacity:1;
  outline:2px solid var(--gold);
}

.pd-price{
  font-size:22px;
  font-weight:900;
  color:var(--gold);
  margin-bottom: 20px;
}

.pd-info {
  padding-left: 10px;
}
.pd-info h2 {
  margin-bottom: 6px;
}
#pdDetails > div {
  padding: 6px 0;
  border-bottom: 1px dashed rgba(255,255,255,0.08);
}

/* ================= REVIEWS ================= */
.review-stars span{
  font-size:22px;
  cursor:pointer;
  color:#555;
}

.review-stars span.active{
  color:var(--gold);
}

.reviews-list{
  display:flex;
  flex-direction:column;
  gap:10px;
  margin-top:10px;
}

.review-item{
  background: rgba(255,255,255,0.04);
  border-left: 3px solid var(--gold);
  border-radius: 12px;
  padding:10px;
}

/* ================= ADMIN INPUTS ================= */
.field input,
.field textarea{
  width:100%;
  background:#0f1738;
  border:1px solid var(--border);
  border-radius:12px;
  padding:10px;
  color:var(--text-main);
}
.imageUrlInput.invalid {
  border-color: var(--danger);
  box-shadow: 0 0 0 1px rgba(255,107,107,0.4);
}
.imageUrlInput.valid {
  border-color: var(--success);
}

/* ================= MOBILE ================= */
@media(max-width:768px){
  header{flex-direction:column}
  .hero{grid-template-columns:1fr}
  .pd-layout{grid-template-columns:1fr}
  .modal-box {
    max-height: 88vh;
    overflow-y: auto;
  }
  /* Add padding to modal content so sticky bar doesn't cover content */
  .product-detail-box { padding-bottom: 80px !important; }
}
.imgwrap{
  position:relative; /* ðŸ”’ fixes flicker */
}
.tag{
  pointer-events:none;
  will-change:transform;
  transform:translateZ(0);
}

/* A simple toast notification */
#toast {
  visibility: hidden; opacity: 0;
  position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%) translateY(20px);
  background: linear-gradient(90deg,var(--gold),#f3d48c); color: #3b2b08;
  padding: 12px 24px; border-radius: 50px; font-weight: 800;
  z-index: 9999; box-shadow: 0 10px 30px rgba(0,0,0,0.3);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
}
#toast.show { visibility: visible; opacity: 1; transform: translateX(-50%) translateY(0); }

/* Scroll Reveal Animation */
.reveal { opacity: 0; transform: translateY(30px); transition: all 0.8s cubic-bezier(0.5, 0, 0, 1); }
.reveal.active { opacity: 1; transform: translateY(0); }

.sr-only{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border-width:0; }

/* ================= SPINNER ================= */
.spinner {
  width: 32px;
  height: 32px;
  border: 3px solid rgba(230,181,102,0.3);
  border-radius: 50%;
  border-top-color: var(--gold);
  animation: spin 1s linear infinite;
  margin: 20px auto;
}
@keyframes spin { to { transform: rotate(360deg); } }

/* ================= ACTIVE FILTERS ================= */
.color-filter-item.active-filter, .filter-item.active-filter {
  border-color: var(--gold);
  background: var(--gold) !important;
  color: #0a0e1a !important;
  font-weight: 700;
  box-shadow: 0 0 15px rgba(230, 181, 102, 0.5);
}

/* ================= UTILITY CLASSES (Optimized) ================= */
.product-card-footer {
  margin-top: auto;
  padding-top: 12px;
}
.orderBtn {
  visibility: hidden;
  transform: translateY(8px);
  pointer-events: none;
  transition: opacity 0.25s ease, transform 0.25s ease, visibility 0.25s;
}
.card:hover .orderBtn {
  visibility: visible;
  transform: translateY(0);
  pointer-events: auto;
}
@media (hover: none) {
  .orderBtn {
    visibility: visible;
    transform: none;
    pointer-events: auto;
  }
  .card:hover { transform: none; box-shadow: none; }
}
.admin-product-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px;
  border-bottom: 1px solid rgba(255,255,255,0.05);
  background: rgba(255,255,255,0.02);
  border-radius: 8px;
  margin-bottom: 8px;
  transition: none !important;
  transform: none !important;
}
.admin-product-row:hover { background: rgba(255,255,255,0.04); transform: none !important; box-shadow: none !important; }

.empty-state {
  grid-column: 1 / -1;
  text-align: center; margin-top: 20px;
  color: var(--text-muted);
  padding: 40px;
  background: rgba(255,255,255,0.02);
  border-radius: 16px;
  border: 1px dashed var(--border);
}

/* ================= OPTIMIZATION CLASSES ================= */
.multi-img-badge {
  position: absolute; bottom: 8px; right: 8px;
  background: rgba(0,0,0,0.6); backdrop-filter: blur(4px);
  color: white; padding: 2px 8px; border-radius: 10px;
  font-size: 11px; font-weight: 600; letter-spacing: 0.5px;
}
.card-details-grid {
  margin-top: 10px; font-size: 12px; color: var(--text-muted);
  display: grid; gap: 4px;
}
.filter-count { margin-left: 4px; color: var(--text-muted); }
.admin-product-img {
  width: 72px;
  height: 72px;
  background: #0b1020;
  border-radius: 8px;
  overflow: hidden;
  flex-shrink: 0;
  margin-right: 12px;
}
.admin-product-img img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  image-rendering: auto;
  display: block;
}
.related-card {
  padding: 10px; box-shadow: none;
  background: rgba(255,255,255,0.03); cursor: pointer;
  border-radius: 12px; transition: background 0.2s;
}
.related-card:hover { background: rgba(255,255,255,0.06); }
.related-img-wrap { aspect-ratio: 3/4; border-radius: 8px; overflow: hidden; margin-bottom: 8px; }

/* ================= ADMIN LAYOUT ================= */
.admin-form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
.admin-form-full { grid-column: 1 / -1; }
@media(max-width: 600px) { .admin-form-grid { grid-template-columns: 1fr; } }

/* ================= CART & BADGES ================= */
.cart-btn-wrap { position: relative; cursor: pointer; margin-right: 12px; display: flex; align-items: center; }
.cart-badge {
  position: absolute; top: -5px; right: -8px;
  background: var(--danger); color: white;
  font-size: 10px; font-weight: 700;
  width: 18px; height: 18px; border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
}
.cart-item { display: flex; gap: 12px; margin-bottom: 12px; background: rgba(255,255,255,0.03); padding: 10px; border-radius: 12px; align-items: center; }
.cart-item img { width: 50px; height: 50px; object-fit: cover; border-radius: 8px; }
.cart-total { font-size: 18px; font-weight: 800; color: var(--gold); text-align: right; margin-top: 20px; padding-top: 10px; border-top: 1px solid var(--border); }

/* ================= SKELETON LOADING ================= */
.skeleton { background: linear-gradient(90deg, #131b36 25%, #1c2645 50%, #131b36 75%); background-size: 200% 100%; animation: skeletonLoading 1.5s infinite; border-radius: 8px; }
@keyframes skeletonLoading { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
.skeleton-card { height: 400px; border-radius: 18px; border: 1px solid rgba(255,255,255,0.05); }

/* ================= SHIMMER EFFECT ================= */
.shimmer { position: relative; overflow: hidden; }
.shimmer::after { content: ''; position: absolute; top: 0; left: -100%; width: 50%; height: 100%; background: linear-gradient(to right, transparent, rgba(255,255,255,0.3), transparent); transform: skewX(-25deg); animation: shimmer 3s infinite; }
@keyframes shimmer { 100% { left: 200%; } }

/* ================= ENHANCED FOOTER ================= */
.footer-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 40px; padding: 60px 20px; background: linear-gradient(180deg, #0a0e1a 0%, #050810 100%); border-top: 1px solid var(--border); margin-top: 60px; }
.footer-col h4 { color: var(--gold); margin-bottom: 20px; font-size: 16px; font-weight: 700; letter-spacing: 0.5px; }
.footer-col a { display: block; color: var(--text-muted); text-decoration: none; margin-bottom: 12px; font-size: 14px; transition: color 0.2s; }
.footer-col a:hover { color: var(--gold); transform: translateX(5px); }
.social-icons { display: flex; gap: 12px; margin-top: 20px; }
.social-icon { width: 40px; height: 40px; border-radius: 50%; background: rgba(255,255,255,0.05); display: flex; align-items: center; justify-content: center; transition: 0.3s; color: var(--text-main); border: 1px solid var(--border); }
.social-icon:hover { background: var(--gold); color: #000; transform: translateY(-3px); box-shadow: 0 5px 15px rgba(230, 181, 102, 0.3); }
.footer-bottom { text-align: center; padding: 20px; background: #020408; color: #5a6b8c; font-size: 13px; border-top: 1px solid rgba(255,255,255,0.03); }

/* ================= SECTION TITLE ACCENT ================= */
.section-title { position: relative; display: inline-block; margin-bottom: 20px; }
.section-title::after { content: ''; position: absolute; bottom: -8px; left: 0; width: 60px; height: 4px; background: linear-gradient(90deg, var(--gold), transparent); border-radius: 2px; }

/* ================= PULSE ANIMATION ================= */
@keyframes pulse-gold {
  0% { box-shadow: 0 0 0 0 rgba(230, 181, 102, 0.7); }
  70% { box-shadow: 0 0 0 10px rgba(230, 181, 102, 0); }
  100% { box-shadow: 0 0 0 0 rgba(230, 181, 102, 0); }
}

/* ================= BACK TO TOP ================= */
.back-to-top {
  position: fixed; bottom: 100px; right: 30px;
  width: 40px; height: 40px;
  background: var(--bg-panel); border: 1px solid var(--border);
  border-radius: 50%; display: flex; align-items: center; justify-content: center;
  color: var(--gold); cursor: pointer;
  opacity: 0; visibility: hidden; transition: all 0.3s;
  z-index: 890; /* Below floating cart */
  box-shadow: 0 5px 15px rgba(0,0,0,0.3);
}
#pdOrderBtn:not(:disabled) { animation: pulse-gold 2s infinite; }

/* ================= COLLECTIONS ================= */
.collections-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 40px; }
.collection-card { position: relative; height: 250px; border-radius: 16px; overflow: hidden; cursor: pointer; border: 1px solid var(--border); }
.collection-card img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.7s cubic-bezier(0.25, 0.8, 0.25, 1); }
.collection-card:hover img { transform: scale(1.1); }
.collection-overlay { position: absolute; inset: 0; background: linear-gradient(to top, rgba(0,0,0,0.9), transparent); display: flex; flex-direction: column; justify-content: flex-end; padding: 24px; }
.collection-overlay h3 { margin: 0 0 5px 0; font-size: 22px; color: white; font-weight: 700; }
.btn-text { color: var(--gold); font-weight: 700; font-size: 14px; opacity: 0; transform: translateX(-10px); transition: all 0.3s; display: flex; align-items: center; gap: 6px; }
.collection-card:hover .btn-text { opacity: 1; transform: translateX(0); }
.back-to-top.show { opacity: 1; visibility: visible; }
.back-to-top:hover { background: var(--gold); color: #000; transform: translateY(-3px); }

/* ================= WHATSAPP FLOAT ================= */
.whatsapp-float { position: fixed; bottom: 30px; left: 30px; width: 50px; height: 50px; background: #25D366; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 10px 30px rgba(37, 211, 102, 0.3); z-index: 900; transition: transform 0.3s; text-decoration: none; }
.whatsapp-float:hover { transform: translateY(-5px); box-shadow: 0 15px 35px rgba(37, 211, 102, 0.5); }

/* ================= STATS ================= */
.stats-section { display: flex; justify-content: space-around; flex-wrap: wrap; gap: 20px; padding: 40px 20px; background: rgba(255,255,255,0.02); border-top: 1px solid var(--border); border-bottom: 1px solid var(--border); margin: 40px 0; }
.stat-item { text-align: center; flex: 1; min-width: 150px; }
.stat-number { font-size: 32px; font-weight: 800; color: var(--gold); display: block; margin-bottom: 5px; }
.stat-label { color: var(--text-muted); font-size: 14px; text-transform: uppercase; letter-spacing: 1px; }

/* ================= TESTIMONIALS ================= */
.testimonials-scroll { display: flex; gap: 20px; overflow-x: auto; padding-bottom: 20px; scroll-snap-type: x mandatory; -webkit-overflow-scrolling: touch; }
.testimonial-card { min-width: 300px; max-width: 300px; background: #131b36; padding: 20px; border-radius: 16px; border: 1px solid var(--border); scroll-snap-align: start; position: relative; }
.testimonial-card::before { content: 'â€œ'; position: absolute; top: 10px; right: 20px; font-size: 60px; color: rgba(230, 181, 102, 0.1); font-family: serif; line-height: 1; }
.t-user { display: flex; align-items: center; gap: 10px; margin-top: 15px; }
.t-avatar { width: 40px; height: 40px; background: var(--gold); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; color: #000; }

/* ================= FAQ ================= */
.faq-grid { display: grid; gap: 15px; max-width: 800px; margin: 0 auto; }
.faq-item { background: rgba(255,255,255,0.03); border-radius: 12px; border: 1px solid var(--border); overflow: hidden; transition: all 0.3s; }
.faq-item:hover { background: rgba(255,255,255,0.05); }
.faq-question { width: 100%; text-align: left; padding: 15px 20px; background: none; border: none; color: var(--text-main); font-weight: 600; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
.faq-answer { padding: 0 20px 15px; color: var(--text-muted); line-height: 1.6; font-size: 14px; display: none; }
.faq-item.active .faq-answer { display: block; animation: fadeIn 0.3s; }
.faq-icon { transition: transform 0.3s; }
.faq-item.active .faq-icon { transform: rotate(180deg); }

/* ================= EMPTY STATES ================= */
.empty-state-content {
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  padding: 40px 20px; text-align: center; color: var(--text-muted);
}
.empty-icon {
  width: 64px; height: 64px; margin-bottom: 16px; opacity: 0.3; stroke-width: 1.5;
}

/* ================= QUICK FILTERS ================= */
.quick-filter-scroll {
  display: flex; gap: 10px; overflow-x: auto; padding: 4px 4px 16px;
  margin-bottom: 20px;
  -webkit-overflow-scrolling: touch;
  scrollbar-width: none; /* Firefox */
}
.quick-filter-scroll::-webkit-scrollbar { display: none; }
.qf-chip {
  background: rgba(255,255,255,0.03); border: 1px solid var(--border);
  padding: 8px 20px; border-radius: 30px; white-space: nowrap;
  font-size: 13px; font-weight: 500; color: var(--text-muted);
  cursor: pointer; transition: background 0.3s ease, color 0.3s ease, transform 0.3s ease, border-color 0.3s ease; flex-shrink: 0;
  user-select: none;
}
.qf-chip:hover { background: rgba(255,255,255,0.08); color: var(--text-main); transform: translateY(-2px); border-color: rgba(255,255,255,0.2); }
.qf-chip.active { background: var(--gold); color: #0a0e1a; border-color: var(--gold); box-shadow: 0 4px 15px rgba(230, 181, 102, 0.3); font-weight: 700; }

/* ================= CARD SWATCHES ================= */
.card-swatches { display: flex; gap: 6px; margin-top: 10px; align-items: center; min-height: 14px; }
.card-swatch { width: 12px; height: 12px; border-radius: 50%; border: 1px solid rgba(255,255,255,0.3); position: relative; transition: transform 0.2s; }
.card-swatch:hover { transform: scale(1.3); border-color: var(--gold); z-index: 2; }

/* ================= TRUST STRIP ================= */
.trust-section {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
  gap: 16px;
  margin-bottom: 40px;
}
.trust-item {
  background: rgba(255,255,255,0.02);
  border: 1px solid var(--border);
  padding: 20px;
  border-radius: 16px;
  text-align: center;
  display: flex; flex-direction: column; align-items: center; gap: 8px;
  transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
  backdrop-filter: blur(5px);
}
.trust-item:hover { transform: translateY(-5px); border-color: var(--gold); background: rgba(255,255,255,0.05); box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
.trust-item svg { margin-bottom: 4px; filter: drop-shadow(0 0 8px rgba(230, 181, 102, 0.3)); }

/* ================= UI POLISH ================= */
.bg-noise {
  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  pointer-events: none; z-index: 0; opacity: 0.04;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
}
.addToCartBtn {
  border-radius: 50% !important; width: 42px; height: 42px; padding: 0 !important;
  display: flex; align-items: center; justify-content: center;
  border: 1px solid var(--border); color: var(--gold); transition: all 0.3s ease;
}
.addToCartBtn:hover { background: var(--gold); color: #0a0e1a; transform: scale(1.1); border-color: var(--gold); box-shadow: 0 0 15px rgba(230, 181, 102, 0.4); }
.wishlist-footer-btn {
  border-radius: 50% !important; width: 42px; height: 42px; padding: 0 !important;
  display: flex; align-items: center; justify-content: center;
  border: 1px solid var(--border); color: var(--text-muted); transition: all 0.3s ease;
}
.wishlist-footer-btn:hover { background: rgba(255, 107, 107, 0.1); color: var(--danger); border-color: var(--danger); transform: scale(1.1); }

/* ================= IMPROVED ZOOM UI ================= */
.pd-main-img {
  cursor: zoom-in;
}
.pd-thumbs img:hover { opacity: 1; transform: translateY(-2px); transition: all 0.2s; }

#zoomModal {
  background: rgba(0, 0, 0, 0);
  transition: background 0.25s ease;
}
#zoomModal.show {
  background: rgba(0, 0, 0, 0.92);
}
#zoomModal .modal-box {
  background: transparent;
  box-shadow: none;
  border: none;
  padding: 0;
  width: 100%;
  height: 100%;
  max-width: none;
  max-height: none;
  display: flex;
  align-items: center;
  justify-content: center;
}

#zoomImg {
  max-width: 90vw;
  max-height: 90vh;
  object-fit: contain;
  border-radius: 4px;
  box-shadow: 0 0 50px rgba(0,0,0,0.8);
  cursor: crosshair;
  background: radial-gradient(circle, #222 10%, #111 70%);
  transition: transform 0.1s ease-out, opacity 0.3s ease;
  will-change: transform;
}
#zoomModal .close-x {
  position: fixed;
  top: 30px;
  right: 30px;
  width: 44px;
  height: 44px;
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(4px);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #fff;
  font-size: 24px;
  border: 1px solid rgba(255,255,255,0.2);
  transition: all 0.2s;
  z-index: 1100;
  float: none;
}
#zoomModal .close-x:hover {
  background: var(--gold);
  color: #0a0e1a;
  transform: rotate(90deg);
}

/* ================= MOBILE STICKY CTA ================= */
.mobile-sticky-cta {
  display: none; position: fixed; bottom: 0; left: 0; width: 100%;
  background: var(--bg-panel); border-top: 1px solid var(--border);
  padding: 12px 16px; z-index: 1100; align-items: center; gap: 12px;
  box-shadow: 0 -5px 20px rgba(0,0,0,0.5);
}

/* Wishlist Grid in Modal */
.wishlist-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 16px; }
.wishlist-item { background: rgba(255,255,255,0.03); border-radius: 12px; padding: 10px; position: relative; border: 1px solid var(--border); }
.wishlist-item img { width: 100%; aspect-ratio: 3/4; object-fit: cover; border-radius: 8px; margin-bottom: 8px; }
</style>

</head>
<body>
  <div class="bg-noise"></div>
  <div class="announcement-bar">
    <p>Welcome to Hamsa Sarees</p>
  </div>
  <div class="container">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"><img src="hamsasareeslogo.jpg" alt="Hamsa Sarees Logo"></div>
        <div>
          <div class="title">Hamsa Sarees</div>
          <div class="small">Online Store<br>âš  This Website is now under Construction âš </div>
        </div>
      </div>

      <div style="flex:1;display:flex;justify-content:center">
        <div class="search" role="search" aria-label="Search products">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M21 21l-4.35-4.35" stroke="#9fb6c9" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
          <input id="searchBox" placeholder="Search sarees, cotton, silk..." aria-label="Search products" />
          <button id="clearSearch" class="search-clear" aria-label="Clear search">âœ•</button>
        </div>
      </div>

      <div class="actions">
        <div id="openCartBtn" class="cart-btn-wrap" aria-label="Open Cart">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg>
          <div id="cartCount" class="cart-badge" style="display:none">0</div>
        </div>

        <button id="adminBtn" class="btn-ghost" style="display:none" aria-hidden="true">Admin</button>
        <div id="userBadge" style="display:none;background:rgba(255,255,255,0.03);padding:8px 10px;border-radius:10px;color:#fff;font-weight:700"></div>
        <a id="myOrdersBtn" href="yourorders.html" class="btn-ghost" style="display:none">My Orders</a>
        <button id="wishlistBtn" class="btn-ghost" style="display:none">Wishlist</button>
        <button id="profileBtn" class="btn-ghost" style="display:none">Profile</button>
        <button id="signOutBtn" class="btn-ghost" style="display:none">Sign out</button>
        <button id="loginShowBtn" class="btn">Sign in</button>
      </div>
    </header>

    <main>
      <section class="hero">
        <div class="hero-card">
          <div class="hero-content">
            <div class="badge-pill shimmer">Welcome</div>
            <h1>Hamsa Sarees</h1>
            <p class="hero-desc">Discover our exclusive collection of sarees.</p>
            <div class="hero-address">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="var(--gold)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>
              <span>22/3, Tharamangalam Main Road, Jalakandapuram, Salem 636501</span>
            </div>
            <a href="https://www.google.com/maps/search/?api=1&query=Hamsa+Sarees+Jalakandapuram" target="_blank" rel="noopener noreferrer" class="btn btn-icon">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>
              <span>Locate Us on Google</span>
            </a>
          </div>
        </div>
      </section>

      <!-- Trust Strip -->
      <section class="trust-section reveal">
        <div class="trust-item">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--gold)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="1" y="3" width="15" height="13"></rect><polygon points="16 8 20 8 23 11 23 16 16 16 16 8"></polygon><circle cx="5.5" cy="18.5" r="2.5"></circle><circle cx="18.5" cy="18.5" r="2.5"></circle></svg>
          <span class="small" style="font-weight:700;color:var(--text-main)">Free Shipping</span>
          <span class="small" style="font-size:11px;color:var(--text-muted)">On all orders</span>
        </div>
        <div class="trust-item">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--gold)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
          <span class="small" style="font-weight:700;color:var(--text-main)">Secure Payment</span>
          <span class="small" style="font-size:11px;color:var(--text-muted)">100% Secure Checkout</span>
        </div>
        <div class="trust-item">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--gold)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg>
          <span class="small" style="font-weight:700;color:var(--text-main)">Best Prices</span>
          <span class="small" style="font-size:11px;color:var(--text-muted)">Direct from Weavers</span>
        </div>
        <div class="trust-item">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--gold)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path></svg>
          <span class="small" style="font-weight:700;color:var(--text-main)">Top Quality</span>
          <span class="small" style="font-size:11px;color:var(--text-muted)">Handpicked Sarees</span>
        </div>
      </section>

      <!-- Quick Filter Chips -->
      <div class="quick-filter-scroll" id="quickFilterScroll">
        <div class="qf-chip active" data-type="all">All Products</div>
        <div class="qf-chip" data-type="tag" data-val="New">New Arrivals</div>
        <div class="qf-chip" data-type="tag" data-val="Best Seller">Best Sellers</div>
        <div class="qf-chip" data-type="material" data-val="silk">Silk Sarees</div>
        <div class="qf-chip" data-type="material" data-val="cotton">Cotton Sarees</div>
        <div class="qf-chip" data-type="price" data-val="0-2000">Under â‚¹2000</div>
      </div>

      <!-- Filters Section -->
      <section class="filter-section">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
          <h3 class="section-title" style="margin:0; font-size:16px;">Filters</h3>
          <button id="clearFiltersBtn" class="btn-ghost" style="font-size:12px; padding:6px 12px;">Clear All</button>
        </div>
        <div id="filterGroupsContainer" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
            <div id="colorFilterGroup">
              <h4 style="margin: 0 0 10px 0; font-size: 14px;">By Color</h4>
              <div id="colorFiltersContainer" class="color-filter-grid"></div>
            </div>
            <div id="priceFilterGroup"></div>
            <div id="materialFilterGroup"></div>
            <div id="styleFilterGroup"></div>
            <div id="designFilterGroup"></div>
            <div id="availabilityFilterGroup"></div>
            <div id="activeFiltersBar" class="small" style="grid-column: 1/-1; margin-top:12px; color:var(--gold); display:none; border-top:1px solid rgba(255,255,255,0.05); padding-top:12px;"></div>
        </div>
      </section>

      <section style="margin-top:12px">
        <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px">
          <h2 class="section-title" style="margin:0">Products</h2>
          <div style="display:flex;align-items:center;gap:10px">
             <select id="sortSelect" class="btn-ghost" style="padding:8px;font-size:13px;outline:none;background:#0f1738;">
               <option value="newest">Newest First</option>
               <option value="priceLow">Price: Low to High</option>
               <option value="priceHigh">Price: High to Low</option>
             </select>
          </div>
        </div>
        <div class="small" style="opacity:.7; margin-bottom:10px">Loading latest sarees...</div>
        <div class="grid" id="productGrid" aria-live="polite" style="min-height:200px;">
          <!-- Initial Loading State -->
          <div class="card skeleton skeleton-card"></div>
          <div class="card skeleton skeleton-card"></div>
          <div class="card skeleton skeleton-card"></div>
          <div class="card skeleton skeleton-card"></div>
          <div class="card skeleton skeleton-card"></div>
          <div class="card skeleton skeleton-card"></div>
        </div>
      </section>
    </main>
  </div>

  <div class="modal" id="loginModal" aria-hidden="true">
    <div class="modal-box" role="dialog" aria-modal="true">
      <button class="close-x" id="closeLogin" title="Close">âœ•</button>
      <h2>Sign in with Google</h2>
      <p class="small">No typing required â€” uses Google auth.</p>
      <div style="display:flex;justify-content:center;margin-top:12px">
        <button id="googleBtnLarge" class="btn">Sign in with Google</button>
      </div>
      <p id="loginErr" class="small" style="margin-top:12px;color:#ffb4b4;display:none"></p>
    </div>
  </div>

  <div class="modal" id="orderDetailModal" aria-hidden="true">
    <div class="modal-box" role="dialog" aria-modal="true">
      <button class="close-x" id="closeOrderDetail" title="Close">âœ•</button>
      <h2>Order Details</h2>
      <div id="orderDetailContent" class="small" style="white-space:pre-line;margin-top:8px"></div>
      <div style="display:flex;gap:10px;margin-top:12px;justify-content:flex-end"><button id="closeDetailBtn" class="btn-ghost">Close</button></div>
    </div>
  </div>

  <div class="modal" id="profileModal" aria-hidden="true">
    <div class="modal-box" role="dialog" aria-modal="true">
      <button class="close-x" id="closeProfile" title="Close">âœ•</button>
      <h2>My Profile</h2>
      <p class="small">Manage your shipping details for faster checkout.</p>
      
      <div class="field">
        <label class="small" style="font-weight:600">Name</label>
        <input id="profileName" placeholder="Your Name">
      </div>
      <div class="field">
        <label class="small" style="font-weight:600">Email (Read-only)</label>
        <input id="profileEmail" readonly style="opacity:0.7;cursor:not-allowed">
      </div>
      <div class="field">
        <label class="small" style="font-weight:600">Phone Number</label>
        <input id="profilePhone" placeholder="10-digit mobile number">
      </div>
      <div class="field">
        <label class="small" style="font-weight:600">Delivery Address</label>
        <textarea id="profileAddress" placeholder="Full delivery address"></textarea>
        <div id="profileError" class="error-message"></div>
      </div>
      <div style="margin-top:12px;display:flex;justify-content:flex-end">
        <button id="saveProfileBtn" class="btn">Save Profile</button>
      </div>
    </div>
  </div>

  <div class="modal" id="wishlistModal" aria-hidden="true">
    <div class="modal-box" role="dialog" aria-modal="true">
      <button class="close-x" id="closeWishlist" title="Close">âœ•</button>
      <h2>My Wishlist</h2>
      <div id="wishlistContent" style="margin-top:16px; max-height:60vh; overflow-y:auto;">
        <!-- Wishlist items will be injected here -->
      </div>
    </div>
  </div>

<div class="modal" id="adminModal" aria-hidden="true">
  <div class="modal-box" role="dialog" aria-modal="true" style="max-height:90vh;overflow-y:auto">
    <button class="close-x" id="closeAdmin" title="Close">âœ•</button>
    <h2>Admin Panel</h2>

    <!-- ADD / EDIT PRODUCT -->
    <div style="border-bottom:1px solid rgba(255,255,255,0.06);padding:16px;margin-bottom:16px;background:rgba(255,255,255,0.01);border-radius:10px">
      <h3 id="adminFormTitle" style="margin-top:0;color:#eaf6ff">Add Product</h3>
      <p class="small">Only admin can add or edit products.</p>

      <div class="admin-form-grid">
        <div class="field admin-form-full">
          <label class="small" style="font-weight:600">Title *</label>
          <input id="admin_pTitle" placeholder="Product title">
        </div>

        <div class="field">
          <label class="small" style="font-weight:600">Selling Price (â‚¹) *</label>
          <input id="admin_pPrice" type="number" placeholder="1499">
        </div>

        <div class="field">
          <label class="small" style="font-weight:600">MRP (â‚¹)</label>
          <input id="admin_pMrp" type="number" placeholder="1999">
        </div>

        <div class="field">
          <label class="small" style="font-weight:600">Tag</label>
          <input id="admin_pTag" placeholder="New / Best Seller">
        </div>

        <div class="field">
          <label class="small" style="font-weight:600">Stock Qty</label>
          <input id="admin_pStock" type="number" placeholder="e.g., 10">
        </div>

        <div class="field admin-form-full">
          <label class="small" style="font-weight:600">Colors (comma-separated) *</label>
          <input id="admin_pColors" placeholder="e.g., red, gold, blue">
        </div>

        <div class="field">
          <label class="small" style="font-weight:600">Material</label>
          <input id="admin_pMaterial" placeholder="e.g., Cotton, Silk">
        </div>

        <div class="field">
          <label class="small" style="font-weight:600">Style</label>
          <input id="admin_pStyle" placeholder="e.g., Kanjivaram">
        </div>

        <div class="field">
          <label class="small" style="font-weight:600">Design</label>
          <input id="admin_pDesign" placeholder="e.g., Floral">
        </div>

        <div class="field">
          <label class="small" style="font-weight:600">Blouse</label>
          <input id="admin_pBlouse" placeholder="e.g., Yes, No">
        </div>
      </div>

      <div class="field" style="margin-top: 16px;">
        <label class="small" style="font-weight:600">Image URLs</label>
        <div id="imageUrlsContainer">
          <input class="imageUrlInput" placeholder="Image URL 1" style="margin-bottom:8px">
        </div>
        <button id="addImageUrl" type="button" class="btn-ghost" style="margin-top:8px">Add another image</button>
      </div>

      <div class="field">
        <label class="small" style="font-weight: 600;">Image Preview</label>
        <img id="admin_pPreview" src="" alt="Product Image Preview" style="max-width: 100%; max-height: 200px; border: 1px solid var(--border); border-radius: 8px; margin-top: 8px; display: none;">
      </div>

      <div style="margin-top:12px;display:flex;gap:8px;justify-content:flex-end">
        <button id="adminClearForm" class="btn-ghost" style="font-size:12px;">Clear Form</button>
        <button id="adminCancelEdit" class="btn-ghost" style="display:none">Cancel Edit</button>
        <button id="adminSave" class="btn">Add Product</button>
        <div id="adminError" class="error-message" style="margin-left:10px;align-self:center"></div>
      </div>
    </div>

    <!-- PRODUCT LIST -->
    <div>
      <h3 style="margin-top:0;color:#eaf6ff">All Products</h3>
      <div id="adminProductsList" style="border:1px solid rgba(255,255,255,0.06);border-radius:10px;max-height:400px;overflow-y:auto;background:rgba(255,255,255,0.01)">
        <div class="small" style="padding:12px;text-align:center;color:var(--muted)">Loading products...</div>
      </div>
    </div>

    <div style="margin-top:16px;display:flex;justify-content:flex-end">
      <button class="close-x btn-ghost">Close</button>
    </div>
  </div>
</div>

<div class="modal" id="cartModal" aria-hidden="true">
  <div class="modal-box" role="dialog" aria-modal="true">
    <button class="close-x" id="closeCart" title="Close">âœ•</button>
    <h2>Your Cart</h2>
    
    <div id="cartItemsList" style="max-height: 60vh; overflow-y: auto; margin-top: 16px;">
      <div class="small" style="text-align:center; color:var(--text-muted)">Your cart is empty</div>
    </div>
    <div id="cartFooter" style="display:none">
      <div class="cart-total">Total: <span id="cartTotalAmount">â‚¹0</span></div>
      <div style="margin-top:16px; display:flex; justify-content:flex-end; gap:10px;">
        <button id="clearCartBtn" class="btn-ghost">Clear Cart</button>
        <button id="checkoutCartBtn" class="btn">Checkout</button>
      </div>
    </div>
  </div>
</div>

<script type="module">

(async function(){
  if(document.readyState === 'loading') await new Promise(r=>document.addEventListener('DOMContentLoaded', r));
  const $ = id => document.getElementById(id);
  // 1ï¸âƒ£ CACHE DOM QUERIES
  const productGrid = $('productGrid');
  const searchBox = $('searchBox');
  const sortSelect = $('sortSelect');
  let currentEditingId = null; // To track which product is being edited
  let allProducts = []; // Master list of all products from Firestore
  let isProfileForced = false; // ðŸ”’ Profile Enforcement Flag
  function openModal(modal){ if(!modal) return; modal.classList.add('show'); modal.removeAttribute('aria-hidden'); document.documentElement.style.overflow = 'hidden'; }
    function closeModal(modal){
  if(!modal) return;

  if(document.activeElement instanceof HTMLElement){
    document.activeElement.blur();
  }

  // ðŸ”’ BLOCK CLOSE IF FORCED
  if(isProfileForced && modal.id === 'profileModal') return;

  modal.classList.remove('show');
  modal.setAttribute('aria-hidden','true');
  document.documentElement.style.overflow = '';
  if(modal.id === 'productDetailModal') document.getElementById('mobileStickyCta').style.display = 'none';
}

  // ================= ZOOM LOGIC (FIXED) =================
  function openZoomFrom(img){
    const rect = img.getBoundingClientRect();
    const zoomModal = document.getElementById('zoomModal');
    const zoomImg = document.getElementById('zoomImg');
    if(!zoomModal || !zoomImg) return;
    
    zoomImg.src = img.src;
    
    // Animation Start State
    zoomImg.style.transition = 'none';
    zoomImg.style.transformOrigin = 'center center';
    zoomImg.style.opacity = '0';
    zoomImg.style.transform = 'scale(0.9)';

    if(document.activeElement instanceof HTMLElement){
      document.activeElement.blur();
    }

    zoomModal.classList.add('show');
    zoomModal.removeAttribute('aria-hidden');
    document.documentElement.style.overflow = 'hidden';
    
    requestAnimationFrame(() => {
      requestAnimationFrame(() => {
        zoomImg.style.transition = '';
        zoomImg.style.opacity = '1';
        zoomImg.style.transform = 'scale(1)';
      });
    });
  }

  document.addEventListener('click', e => {
    const img = e.target.closest('#pdMainImg');
    if(!img || !img.src) return;
    openZoomFrom(img);
  });

  document.getElementById('zoomModal')?.addEventListener('click', () => {
    closeModal(document.getElementById('zoomModal'));
  });
  
  document.getElementById('zoomImg')?.addEventListener('click', e => {
    e.stopPropagation();
  });
  
  // 4ï¸âƒ£ IMAGE ZOOM PERFECTION (Cursor-anchored)
  const zoomImg = document.getElementById('zoomImg');
  if(zoomImg){
    zoomImg.addEventListener('mousemove', e => {
      const rect = zoomImg.getBoundingClientRect();
      const x = ((e.clientX - rect.left) / rect.width) * 100;
      const y = ((e.clientY - rect.top) / rect.height) * 100;
      zoomImg.style.transformOrigin = `${x}% ${y}%`;
      zoomImg.style.transform = 'scale(2.5)';
    });
    zoomImg.addEventListener('mouseleave', () => {
      zoomImg.style.transform = 'scale(1)';
    });
  }
   $('closeZoom')?.addEventListener('click', () => {
    closeModal(document.getElementById('zoomModal'));
  });

  let cart = JSON.parse(localStorage.getItem('hamsaCart') || '[]');
  let currentProductId = null;
let selectedRating = 0;
let wishlistMap = new Map(); // Stores ID -> Data
let wishlistUnsub = null;
let currentReviewsUnsub = null;

  // ---- CONFIG ----
  const ADMIN_UID = 'EenXHJIvZpavhkGTCI8EZyFAfH93'; // UI-only sentinel; enforce admin in Firestore rules / backend
  const firebaseConfig = {
    apiKey: "AIzaSyBozW19Rjc9nj0YabOIE3DlW0qVHtU5XLA",
    authDomain: "hamsasarees-24738.firebaseapp.com",
    projectId: "hamsasarees-24738",
    storageBucket: "hamsasarees-24738.firebasestorage.app",
    messagingSenderId: "16303342424",
    appId: "1:16303342424:web:d68d26160d45472713db2d",
    measurementId: "G-1G1HQGJ5XS"
  };

  // ---- FILTER CONFIG ----
  const FILTERS_CONFIG = {
    colors: {
      red: '#ff4757', blue: '#3742fa', green: '#2ed573', yellow: '#ffc048',
      black: '#2f3542', white: '#ffffff', pink: '#f78fb3', purple: '#8e44ad',
      orange: '#ffa502', brown: '#834822', gold: '#e6b566', silver: '#bdc3c7',
      multicolor: 'linear-gradient(45deg, red, yellow, green, blue)'
    },
    colorGroups: {
      light: ['white', 'cream', 'beige', 'pastel pink', 'pastel blue', 'light yellow'],
      dark: ['black', 'maroon', 'navy blue', 'dark green', 'dark red']
    }
  };
  
  // ---- State for active filters ----
  let activeFilters = {
    colors: new Set(),
    material: new Set(),
    style: new Set(),
    design: new Set(),
    blouse: new Set(),
    stock: new Set(),
    price: new Set()
  };
  // ---- helper: escape text for safe insertion ----
  function escapeHtml(s){ return String(s===undefined||s===null?'':s).replace(/[&<>\"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }

  // ---- Firebase imports (modular) ----
  try{
    const { initializeApp } = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js');
    const authMod = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js');
    const fsMod = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js');

    const { getAuth, GoogleAuthProvider, signInWithPopup, signInWithRedirect, getRedirectResult, signOut, onAuthStateChanged } = authMod;
    const { getFirestore, collection, addDoc, setDoc, doc, getDoc, deleteDoc, serverTimestamp, getDocs, onSnapshot, updateDoc, query, where } = fsMod;

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
    const googleProvider = new GoogleAuthProvider();
    function loadProductReviews(pid){
  if(currentReviewsUnsub) currentReviewsUnsub();
  const pdRating = $('pdRating');
  const reviewsList = $('reviewsList');
  if(!pdRating || !reviewsList) return;

  pdRating.innerText = 'Loading reviews...';
  reviewsList.innerHTML = '<div class="spinner" style="width:20px;height:20px;border-width:2px;margin:10px 0;"></div>';

  const reviewsRef = collection(db, 'products', pid, 'reviews');

  currentReviewsUnsub = onSnapshot(reviewsRef, snap => {
    let sum = 0;
    let count = 0;

    reviewsList.innerHTML = '';

    if (snap.empty) {
      pdRating.innerText = 'No reviews yet';
      reviewsList.innerHTML = '<div class="small">No comments yet.</div>';
      return;
    }

    snap.forEach(d => {
      const r = d.data();
      if(typeof r.rating === 'number'){
        sum += r.rating;
        count++;
      }

      // render comment
      const div = document.createElement('div');
      div.className = 'review-item';

      const verifiedBadge = r.verified ? `<span style="color:var(--success);font-size:11px;margin-left:6px;display:inline-flex;align-items:center;gap:3px;background:rgba(61, 220, 151, 0.1);padding:2px 6px;border-radius:4px;border:1px solid rgba(61, 220, 151, 0.2);" title="Verified Purchase"><svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg> Verified Purchase</span>` : '';

      const stars = 'â˜…'.repeat(r.rating || 0);
const date = r.createdAt?.toDate
  ? r.createdAt.toDate().toLocaleDateString('en-IN', {
      day: '2-digit',
      month: 'short',
      year: 'numeric'
    })
  : '';

div.innerHTML = `
  <div style="display:flex;justify-content:space-between;align-items:center">
    <div><strong>${escapeHtml(r.userName || 'User')}</strong>${verifiedBadge}</div>
    <span style="font-size:12px;color:var(--muted)">${date}</span>
  </div>
  <div class="stars">${stars}</div>
  ${r.text ? `<div class="text">${escapeHtml(r.text)}</div>` : ''}
`;


      reviewsList.appendChild(div);
    });

    pdRating.innerText = `â˜… ${(sum/count).toFixed(1)} (${count} reviews)`;
  }, err => {
    console.warn('Reviews snapshot error:', err);
    pdRating.innerText = 'Ratings unavailable';
  });
}

    // ---- DOM refs ----
    
    const loginModal = $('loginModal'), adminModal = $('adminModal');
    const profileModal = $('profileModal');
    const loginErr = $('loginErr'), userBadge = $('userBadge'), signOutBtn = $('signOutBtn'), loginShowBtn = $('loginShowBtn'), googleBtnLarge = $('googleBtnLarge');
    const cartModal = $('cartModal');
    const wishlistModal = $('wishlistModal');
    const myOrdersBtn = $('myOrdersBtn'), profileBtn = $('profileBtn');
    const adminBtn = $('adminBtn');

    function toast(msg){ 
      if(!toastEl) return; 
      toastEl.innerText = msg; 
      toastEl.classList.add('show'); 
      setTimeout(()=> toastEl.classList.remove('show'), 3000); 
    }
    function showLoginError(msg){ if(!loginErr) return; loginErr.innerText = msg; loginErr.style.display = msg ? 'block' : 'none'; }

    const toastEl = document.getElementById('toast');

    // backdrop click and Esc
    window.addEventListener('keydown', e => { if(e.key==='Escape') document.querySelectorAll('.modal.show').forEach(m=>closeModal(m)); });
    document.querySelectorAll('.modal').forEach(m => m.addEventListener('click', e => { if(e.target===m) closeModal(m); }));
   // ================= REVIEW SYSTEM (FIXED) =================


document.addEventListener('click', e => {
  const star = e.target.closest('#reviewStars span');
  if (!star) return;

  selectedRating = Number(star.dataset.val);
  document.querySelectorAll('#reviewStars span').forEach(s => {
    s.classList.toggle('active', Number(s.dataset.val) <= selectedRating);
  });
});

$('submitReview')?.addEventListener('click', async () => {
  if (!auth.currentUser) {
    alert('Sign in to write a review');
    return;
  }
  if (!currentProductId) {
    alert('Product not selected');
    return;
  }
  if (!selectedRating) {
    alert('Select rating');
    return;
  }

  try {
    // Check for Verified Purchase
    let isVerified = false;
    try {
      const ordersRef = collection(db, 'users', auth.currentUser.uid, 'orders');
      const q = query(ordersRef, where('pid', '==', currentProductId));
      const orderSnap = await getDocs(q);
      if (!orderSnap.empty) isVerified = true;
    } catch (e) { console.warn('Verification check failed', e); }

    await setDoc(
  doc(db, 'products', currentProductId, 'reviews', auth.currentUser.uid),
  {
    rating: selectedRating,
    text: $('reviewText').value.trim(),
    userName: auth.currentUser.displayName || 'Anonymous',
    verified: isVerified,
    createdAt: serverTimestamp()
  }
);
    
    // Recalculate Average Rating for the Product
    const reviewsSnap = await getDocs(collection(db, 'products', currentProductId, 'reviews'));
    let sum = 0;
    reviewsSnap.forEach(d => sum += (d.data().rating || 0));
    const count = reviewsSnap.size;
    const avg = count > 0 ? sum / count : 0;

    // Update Product Document with new stats
    try {
      await setDoc(doc(db, 'products', currentProductId), { _avg: avg, _count: count }, { merge: true });
    } catch (e) {
      // Ignore permission error for non-admins; review is still saved
      console.warn('Skipping product stat update (admin only)');
    }

    toast('Review submitted');
    $('reviewText').value = '';
    selectedRating = 0;
    document.querySelectorAll('#reviewStars span').forEach(s => s.classList.remove('active'));
  } catch (err) {
    console.error('Review save failed', err);
    alert('Failed to submit review');
  }
});

    try {
  const rr = await getRedirectResult(auth);
  if (rr && rr.user) {
    console.log('redirect sign-in OK', rr.user.uid);
  }
} catch (e) {
  console.warn('redirect result', e && e.code);
}

    async function signInPopup(){
      showLoginError('');
      try{ await signInWithPopup(auth, googleProvider); toast('Signed in'); }catch(e){
        console.error('sign-in error', e && e.code, e && e.message);
        const popupErrors = ['auth/popup-blocked','auth/popup-closed-by-user','auth/cancelled-popup-request'];
        if(e && popupErrors.includes(e.code)){
          try{ await signInWithRedirect(auth, googleProvider); return; }catch(err){ showLoginError('Popup blocked and redirect failed. Allow popups or try another browser.'); return; }
        }
        if(e && e.code === 'auth/unauthorized-domain'){
          showLoginError('Domain not authorized. Add your hosting domain in Firebase console â†’ Authentication â†’ Authorized domains.');
        } else showLoginError(e && e.message ? e.message : 'Sign-in failed');
      }
    }
    googleBtnLarge && googleBtnLarge.addEventListener('click', ()=>signInPopup());
    loginShowBtn && loginShowBtn.addEventListener('click', ()=>{ openModal(loginModal); });

    // 7ï¸âƒ£ PREVENT ACCIDENTAL ACTIONS
    signOutBtn && signOutBtn.addEventListener('click', async () => { if(confirm('Are you sure you want to sign out?')) { try{ await signOut(auth); toast('Signed out'); }catch(e){ console.error('signout failed', e); } } });

    // ---- PRODUCTS: load from Firestore (live) ----
    // ================= PRODUCT DETAIL â†’ ORDER NOW =================
    // ---- Helper: Create Pending Order (Stable Architecture) ----
    function createPendingOrder(product, qty = 1) {
      if (!auth.currentUser) {
        openModal(loginModal);
        showLoginError('Please sign in to place orders');
        return;
      }

      const items = [];
      for(let i=0; i<qty; i++) {
        items.push({
          pid: product.id,
          product: product.title,
          price: Number(product.price),
          image: (product.images && product.images[0]) || product.img || ''
        });
      }

      const orderPayload = {
        items: items,
        totalAmount: Number(product.price) * qty,
        lockedAt: Date.now()
      };

      try {
        sessionStorage.setItem('pendingOrder', JSON.stringify(orderPayload));
        window.location.href = 'payment.html';
      } catch (e) {
        console.error("Failed to save order:", e);
        alert("Could not proceed to payment.");
      }
    }

const pdOrderBtn = $('pdOrderBtn');
pdOrderBtn?.addEventListener('click', () => {
    if (!currentProductId) { alert('Product not selected'); return; }
    const product = allProducts.find(p => p.id === currentProductId);
    if (!product) {
        alert('Could not find product details. Please try again.');
        return;
    }
    const qtyInput = $('qtyInput');
    const qty = qtyInput && qtyInput.offsetParent !== null ? (parseInt(qtyInput.value) || 1) : 1;
    createPendingOrder(product, qty);
});

    // ================= WISHLIST LOGIC =================
    async function toggleWishlist(product) {
      if (!auth.currentUser) {
        openModal(loginModal);
        showLoginError('Please sign in to use wishlist');
        return;
      }
      
      const ref = doc(db, 'users', auth.currentUser.uid, 'wishlist', product.id);
      
      // Check if in map to decide action (Optimistic check, real source is Firestore)
      if (wishlistMap.has(product.id)) {
        try {
          await deleteDoc(ref);
          toast('Removed from Wishlist');
        } catch (e) { console.error(e); }
      } else {
        try {
          await setDoc(ref, {
            title: product.title,
            price: Number(String(product.price).replace(/[^\d.]/g, '')),
            image: (product.images && product.images[0]) || product.img || '',
            addedAt: serverTimestamp()
          });
          toast('Added to Wishlist');
        } catch (e) { console.error(e); }
      }
    }

    function updateHeartIcons() {
      document.querySelectorAll('.card').forEach(card => {
        const pid = card.dataset.pid;
        const btn = card.querySelector('.wishlist-btn');
        if (btn) {
          if (wishlistMap.has(pid)) {
            btn.classList.add('active');
          } else {
            btn.classList.remove('active');
          }
        }
      });
    }

    function renderWishlistContent() {
      const container = $('wishlistContent');
      if(!container) return;
      
      if(wishlistMap.size === 0) {
        container.innerHTML = '<div class="empty-state-content"><div class="small">Your wishlist is empty.</div></div>';
        return;
      }

      container.innerHTML = '';
      const grid = document.createElement('div');
      grid.className = 'wishlist-grid';

      wishlistMap.forEach((item, id) => {
        const div = document.createElement('div');
        div.className = 'wishlist-item';
        div.innerHTML = `
            <img src="${item.image || ''}" style="cursor:pointer">
            <div style="font-weight:700; font-size:13px; margin-bottom:4px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">${escapeHtml(item.title)}</div>
            <div style="color:var(--gold); font-weight:600; font-size:13px;">â‚¹${item.price}</div>
        `;
        
        // Image click
        div.querySelector('img').addEventListener('click', () => {
            closeModal(wishlistModal);
            openProductDetail(id);
        });

        // Remove Button
        const btn = document.createElement('button');
        btn.className = 'btn-ghost small remove-wish';
        btn.style.cssText = 'width:100%; margin-top:8px; padding:6px; color:var(--danger); border-color:var(--border);';
        btn.textContent = 'Remove';
        btn.addEventListener('click', async () => {
            if(auth.currentUser && id) {
                await deleteDoc(doc(db, 'users', auth.currentUser.uid, 'wishlist', id));
                toast('Removed');
            }
        });
        div.appendChild(btn);
        grid.appendChild(div);
      });
      container.appendChild(grid);
    }

    $('wishlistBtn')?.addEventListener('click', () => {
      renderWishlistContent();
      openModal(wishlistModal);
    });

    // ================= CART LOGIC =================
    async function saveCart() {
      if(!auth.currentUser) return;
      try {
        await setDoc(doc(db, 'users', auth.currentUser.uid), { cart }, { merge: true });
      } catch(e) { console.error('Save cart error', e); }
    }

    function updateCartUI() {
      const countEl = $('cartCount');
      if(countEl) {
        countEl.innerText = cart.length;
        countEl.style.display = cart.length > 0 ? 'flex' : 'none';
      }
      // Update Floating Cart
      const floatCount = $('floatingCartCount');
      const floatBtn = $('floatingCartBtn');
      if(floatCount && floatBtn) {
        floatCount.innerText = cart.length;
        floatBtn.style.display = 'flex'; // Always show floating cart for easy access
        floatBtn.animate([{ transform: 'scale(1)' }, { transform: 'scale(1.2)' }, { transform: 'scale(1)' }], { duration: 300 });
      }
      localStorage.setItem('hamsaCart', JSON.stringify(cart));
    }
    updateCartUI();

    function addToCart(product) {
      if (!auth.currentUser) {
        openModal(loginModal);
        showLoginError('Please sign in to add items to your cart.');
        return;
      }
      // The button that was clicked to trigger this.
      const triggerBtn = event?.target.closest('button');

      cart.push(product);
      updateCartUI();
      saveCart();
      toast('Added to Cart');

      // 3ï¸âƒ£ MICRO-HAPTIC
      if (navigator.vibrate) navigator.vibrate(20);
      
      // 1ï¸âƒ£ MICRO-FEEDBACK
      if(triggerBtn){
        const originalContent = triggerBtn.innerHTML;
        triggerBtn.innerHTML = 'âœ“';
        triggerBtn.style.background = 'var(--success)';
        setTimeout(() => { triggerBtn.innerHTML = originalContent; triggerBtn.style.background = ''; }, 1500);
      }
    }

    function renderCart() {
      const list = $('cartItemsList');
      const footer = $('cartFooter');
      const totalEl = $('cartTotalAmount');
      if(!list) return;

      list.innerHTML = '';
      if(cart.length === 0) {
        list.innerHTML = `
          <div class="empty-state-content">
            <svg class="empty-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg>
            <div style="font-weight:600; margin-bottom:4px">Your cart is empty</div>
            <div class="small">Looks like you haven't added any sarees yet.</div>
            <button class="btn-ghost" style="margin-top:12px" onclick="document.getElementById('closeCart').click()">Start Shopping</button>
          </div>`;
        footer.style.display = 'none';
        return;
      }

      let total = 0;
      cart.forEach((item, index) => {
        const price = Number(item.price) || 0;
        total += price;
        const div = document.createElement('div');
        div.className = 'cart-item';
        div.innerHTML = `
          <img src="${item.image}" alt="Product">
          <div style="flex:1">
            <div style="font-weight:700; font-size:14px;">${escapeHtml(item.product)}</div>
            <div style="color:var(--gold); font-weight:600;">â‚¹${price}</div>
          </div>
          <button class="btn-ghost remove-cart-item" data-index="${index}" style="padding:6px 10px; color:var(--danger); border-color:var(--border);">âœ•</button>
        `;
        list.appendChild(div);
      });

      totalEl.innerText = 'â‚¹' + total;
      footer.style.display = 'block';

      // Attach remove listeners
      document.querySelectorAll('.remove-cart-item').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const idx = Number(e.target.dataset.index);
          cart.splice(idx, 1);
          updateCartUI();
          saveCart();
          renderCart();
        });
      });
    }

    $('openCartBtn')?.addEventListener('click', () => { renderCart(); openModal(cartModal); });
    $('floatingCartBtn')?.addEventListener('click', () => { renderCart(); openModal(cartModal); });
    $('closeCart')?.addEventListener('click', () => closeModal(cartModal));
    // 7ï¸âƒ£ PREVENT ACCIDENTAL ACTIONS
    $('clearCartBtn')?.addEventListener('click', () => { if(confirm('Are you sure you want to clear your cart?')) { cart = []; updateCartUI(); saveCart(); renderCart(); } });
    $('checkoutCartBtn')?.addEventListener('click', () => {
       if(cart.length === 0) { alert('Cart is empty'); return; }
       const total = cart.reduce((sum, item) => sum + (Number(item.price) || 0), 0);
       const orderPayload = {
         items: cart,
         totalAmount: total,
         lockedAt: Date.now()
       };
       sessionStorage.setItem('pendingOrder', JSON.stringify(orderPayload));
       window.location.href = 'payment.html';
    });

    // ---- Open Product Detail Logic (Centralized) ----
    function openProductDetail(pid) {
      const product = allProducts.find(p => p.id === pid);
      if (!product) return;

      currentProductId = pid;

      // Images
      const images = product.images && product.images.length > 0 ? product.images : (product.img ? [product.img] : []);
      if (images.length === 0) images.push('https://images.unsplash.com/photo-1520975918016-4d0b5b0b2f3d?q=80&w=1200&auto=format&fit=crop&ixlib=rb-4.0.3&s=placeholder');

      $('pdMainImg').src = images[0];
      const thumbs = $('pdThumbs');
      thumbs.innerHTML = '';
      
      if (images.length > 1) {
        images.forEach((src, i) => {
          const t = document.createElement('img');
          t.src = src;
          if (i === 0) t.classList.add('active');
          t.onclick = () => {
            thumbs.querySelectorAll('img').forEach(x => x.classList.remove('active'));
            t.classList.add('active');
            $('pdMainImg').src = src;
          };
          thumbs.appendChild(t);
        });
      }

      // Info
      $('pdTitle').innerText = product.title || 'Untitled';
      
      // Price & MRP Logic for Modal
      const pPrice = Number(product.price || 0);
      const pMrp = Number(product.mrp || pPrice);
      const pdPriceEl = $('pdPrice');
      pdPriceEl.innerHTML = ''; // Clear previous

      if(pMrp > pPrice){
        const oldPrice = document.createElement('span');
        oldPrice.className = 'price-old';
        oldPrice.style.marginRight = '12px';
        oldPrice.style.fontSize = '18px';
        oldPrice.textContent = `â‚¹${pMrp}`;
        pdPriceEl.appendChild(oldPrice);
      }

      const newPrice = document.createElement('span');
      newPrice.textContent = `â‚¹${pPrice}`;
      pdPriceEl.appendChild(newPrice);

      if(pMrp > pPrice){
        const discount = Math.round(((pMrp - pPrice) / pMrp) * 100);
        if(discount > 0){
          const badge = document.createElement('span');
          badge.className = 'discount-badge';
          badge.style.marginLeft = '12px';
          badge.style.fontSize = '14px';
          badge.style.verticalAlign = 'middle';
          badge.textContent = `${discount}% OFF`;
          pdPriceEl.appendChild(badge);
        }
      }
      
      // 9ï¸âƒ£ TRUST SIGNAL
      const trustMsg = document.createElement('div');
      trustMsg.className = 'small';
      trustMsg.style.cssText = 'opacity:0.8; margin-top:12px; font-size:12px; display:grid; gap:4px;';
      trustMsg.innerHTML = ` 
        <div style="display:flex;align-items:center;gap:6px"><span>âœ”</span> Secure payment via Razorpay</div>
        <div style="display:flex;align-items:center;gap:6px"><span>âœ”</span> Easy support via WhatsApp</div>
        <div style="display:flex;align-items:center;gap:6px;opacity:0.7;font-style:italic;margin-top:4px"><span>â„¹</span> Color may slightly vary due to lighting</div>
      `;
      pdPriceEl.appendChild(trustMsg);

      // Details
      const detailsContainer = $('pdDetails');
      detailsContainer.innerHTML = '';
      
      const addDetail = (label, value) => {
         if (!value || (Array.isArray(value) && value.length === 0)) return;
         const formatted = Array.isArray(value) ? value.map(v => v.charAt(0).toUpperCase() + v.slice(1)).join(', ') : value;
         const div = document.createElement('div');
         div.innerHTML = `<span style="font-weight:600; color: var(--text-main);">${label}: </span><span>${formatted}</span>`;
         detailsContainer.appendChild(div);
      };

      addDetail('Material', product.material);
      addDetail('Style', product.style);
      addDetail('Design', product.design);
      addDetail('Colors', product.colors);
      addDetail('Blouse', product.blouse);

      // Stock
      const stock = Number(product.stock || 0);
      const isInStock = stock > 0;
      const stockColor = isInStock ? 'var(--success)' : 'var(--danger)';
      const stockText = isInStock ? 'In Stock' : 'Sold Out';
      const stockEl = document.createElement('div');
      stockEl.innerHTML = `<span style="color: ${stockColor}; font-weight: 600; font-size: 13px;">${stockText}</span>`;
      detailsContainer.appendChild(stockEl);
      
      // Quantity Logic
      const qtySection = $('pdQuantitySection');
      const qtyInput = $('qtyInput');
      const qtyMinus = $('qtyMinus');
      const qtyPlus = $('qtyPlus');
      const qtyMsg = $('qtyStockMsg');

      if(qtySection && qtyInput){
        if(isInStock){
            qtySection.style.display = 'flex';
            qtyInput.value = 1;
            qtyInput.max = stock;
            qtyMsg.style.display = 'none';
            
            qtyMinus.onclick = () => {
                let val = parseInt(qtyInput.value) || 1;
                if(val > 1) { qtyInput.value = val - 1; qtyMsg.style.display = 'none'; }
            };
            qtyPlus.onclick = () => {
                let val = parseInt(qtyInput.value) || 1;
                if(val < stock) { qtyInput.value = val + 1; qtyMsg.style.display = 'none'; }
                else { qtyMsg.innerText = `Max ${stock} available`; qtyMsg.style.display = 'inline'; }
            };
            qtyInput.onchange = () => {
                let val = parseInt(qtyInput.value) || 1;
                if(val < 1) val = 1;
                if(val > stock) { val = stock; qtyMsg.innerText = `Max ${stock} available`; qtyMsg.style.display = 'inline'; }
                else { qtyMsg.style.display = 'none'; }
                qtyInput.value = val;
            };
        } else {
            qtySection.style.display = 'none';
        }
      }

      // Button
      const pdOrderBtn = $('pdOrderBtn');
      if (isInStock) {
        pdOrderBtn.disabled = false;
        pdOrderBtn.textContent = 'Buy Now'; // Language cleanup
      } else {
        pdOrderBtn.disabled = true;
        pdOrderBtn.textContent = 'Out of Stock';
      }

      // Add to Cart Button Logic
      const pdCartBtn = $('pdCartBtn');
      if(pdCartBtn) {
        pdCartBtn.onclick = (e) => {
            const qty = (qtyInput && qtySection.style.display !== 'none') ? (parseInt(qtyInput.value) || 1) : 1;
            for(let i=0; i<qty; i++){
                cart.push({
                    pid: product.id,
                    product: product.title,
                    price: product.price,
                    image: images[0]
                });
            }
            updateCartUI();
            saveCart();
            toast(`${qty} item${qty>1?'s':''} added to Cart`);

            // 1ï¸âƒ£ MICRO-FEEDBACK
            const originalText = pdCartBtn.textContent;
            pdCartBtn.disabled = true;
            pdCartBtn.textContent = 'Added âœ“';
            setTimeout(() => { pdCartBtn.textContent = originalText; pdCartBtn.disabled = !isInStock; }, 1500);
        };
        pdCartBtn.disabled = !isInStock;
      }

      // Reviews
      loadProductReviews(pid);

      // Related Products
      renderRelatedProducts(product);

      // Mobile Sticky CTA Logic
      const stickyCta = $('mobileStickyCta');
      if (stickyCta) {
        const shareBtnHtml = navigator.share ? `
          <button id="stickyShareBtn" class="btn-ghost" title="Share Product" style="width:44px; height:44px; padding:0; border-radius:50%; flex-shrink:0;">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path><polyline points="16 6 12 2 8 6"></polyline><line x1="12" y1="2" x2="12" y2="15"></line></svg>
          </button>
        ` : '';

        stickyCta.innerHTML = `
          ${shareBtnHtml}
          <div style="flex:1; overflow:hidden; white-space:nowrap;">
            <div style="font-size:14px;font-weight:700;color:var(--text-main); text-overflow:ellipsis; overflow:hidden;">${product.title}</div>
            <div style="font-size:16px;font-weight:800;color:var(--gold)">â‚¹${product.price}</div>
          </div>
          <button id="stickyBuyBtn" class="btn" style="width:auto;padding:10px 24px; flex-shrink:0;">Buy Now</button>
        `;

        const stickyBtn = stickyCta.querySelector('#stickyBuyBtn');
        if(stickyBtn) stickyBtn.onclick = () => pdOrderBtn.click();
        if(!isInStock) { stickyBtn.disabled = true; stickyBtn.textContent = 'Out of Stock'; }

        const shareBtn = stickyCta.querySelector('#stickyShareBtn');
        if (shareBtn) {
          shareBtn.onclick = async () => {
            const shareUrl = `${window.location.origin}${window.location.pathname}?product=${product.id}`;
            try {
              await navigator.share({
                title: product.title,
                text: `Check out this saree from Hamsa Sarees: ${product.title}`,
                url: shareUrl
              });
            } catch (err) {
              if (err.name !== 'AbortError') console.error('Share failed:', err);
            }
          };
        }
        stickyCta.style.display = 'flex';
      }

      openModal(document.getElementById('productDetailModal'));
    }

    // ---- Scroll Reveal Observer ----
    const revealObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('active');
          revealObserver.unobserve(entry.target);
        }
      });
    }, { threshold: 0.1 });

    function renderRelatedProducts(currentProduct) {
      const container = $('relatedProductsGrid');
      const section = $('relatedProductsSection');
      if (!container || !section) return;

      const related = allProducts.filter(p => {
        if (p.id === currentProduct.id) return false;
        const sameTag = currentProduct.tag && p.tag && p.tag === currentProduct.tag;
        const sameColor = currentProduct.colors && p.colors && p.colors.some(c => currentProduct.colors.includes(c));
        return sameTag || sameColor;
      }).slice(0, 4);

      if (related.length === 0) {
        section.style.display = 'none';
        return;
      }

      section.style.display = 'block';
      container.innerHTML = '';

      const fragment = document.createDocumentFragment();
      related.forEach(p => {
        const div = document.createElement('div');
        div.className = 'card related-card reveal';
        // Removed inline style in favor of class
        const img = (p.images && p.images[0]) || p.img || 'https://images.unsplash.com/photo-1520975918016-4d0b5b0b2f3d?q=80&w=1200&auto=format&fit=crop&ixlib=rb-4.0.3&s=placeholder';
        
        div.innerHTML = `
          <div class="related-img-wrap">
            <img src="${img}" loading="lazy" style="width:100%; height:100%; object-fit:cover;">
          </div>
          <h4 style="margin:0; font-size:13px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">${p.title}</h4>
          <div style="color:var(--gold); font-weight:700; font-size:13px;">â‚¹${p.price}</div>
        `;
        div.onclick = () => openProductDetail(p.id);
        revealObserver.observe(div);
        fragment.appendChild(div);
      });
      container.appendChild(fragment);
    }

    // ================= PRODUCT CARD CLICK â†’ DETAIL MODAL =================
productGrid.addEventListener('click', e => {
  const card = e.target.closest('.card');
  if (!card) return;
  if (!card.dataset.pid) return;

  // 2ï¸âƒ£ PRODUCT CARD CLICK AREA IS TOO AGGRESSIVE
  // Only allow click on image wrapper or title
  if (!e.target.closest('.imgwrap') && !e.target.tagName.match(/^H3$/i)) return;

  openProductDetail(card.dataset.pid);
});

    // ---- Helper function to add detail rows to a container ----
    function addDetailToCard(container, label, value) {
      if (!value || (Array.isArray(value) && value.length === 0)) return;
      const detailEl = document.createElement('div');
      // This function now expects value to be a pre-formatted string (or HTML)
      const formattedValue = Array.isArray(value) ? value.map(v => v.charAt(0).toUpperCase() + v.slice(1)).join(', ') : value;
      detailEl.innerHTML = `<span style="font-weight:600; color: var(--text-main);">${label}: </span><span>${formattedValue}</span>`;
      container.appendChild(detailEl);
    }

    const productsColRef = collection(db, 'products');

    function renderProductCard(docSnap, index = 0){
      const id = docSnap.id;
      const data = docSnap.data() || {};
      const title = data.title || 'Untitled';
      const createdAt = data.createdAt;
      // Use the 'images' array if it exists, otherwise fall back to 'img'.
      const images = data.images && data.images.length > 0 ? data.images : [data.img];
      const primaryImage = images[0] || 'https://images.unsplash.com/photo-1520975918016-4d0b5b0b2f3d?q=80&w=1200&auto=format&fit=crop&ixlib=rb-4.0.3&s=placeholder';
      const price = String(data.price || '0').replace(/[^\d.]/g, '');
      const stock = Number(data.stock || 0);
      const avg = data._avg ? Number(data._avg).toFixed(1) : null;
      const avgDisplay = avg ? `â˜… ${avg} (${data._count||0})` : 'No ratings';

      const card = document.createElement('div');
      card.className = 'card reveal';
      card.dataset.pid = id;
      
      // 2ï¸âƒ£ QUICK ACTIONS HTML
      const actionsDiv = document.createElement('div');
      actionsDiv.className = 'card-actions';
      actionsDiv.innerHTML = `
        <div class="action-btn quickview-btn" title="Quick View">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
        </div>
      `;
      // Quick View Logic
      actionsDiv.querySelector('.quickview-btn').addEventListener('click', (e) => { e.stopPropagation(); openProductDetail(id); });
      
      card.appendChild(actionsDiv);

      card.style.transitionDelay = `${index * 50}ms`; // Staggered animation
      revealObserver.observe(card);

      // --- IMAGE WRAPPER ---
      const imgWrap = document.createElement('div');
      imgWrap.className = 'imgwrap';

      // Image
      const imgEl = document.createElement('img');
      imgEl.loading = 'lazy';
      imgEl.decoding = 'async';
      imgEl.src = primaryImage;
      imgEl.alt = title;
      imgWrap.appendChild(imgEl);

      // Secondary Image (Hover Effect)
      if(images.length > 1) {
        const secImg = document.createElement('img');
        secImg.className = 'secondary-img';
        secImg.src = images[1];
        secImg.loading = 'lazy';
        secImg.decoding = 'async';
        imgWrap.appendChild(secImg);
      }
      
      // Multi-image indicator
      if (images.length > 1) {
        const multiImgIndicator = document.createElement('div');
        multiImgIndicator.textContent = '1/' + images.length;
        multiImgIndicator.className = 'multi-img-badge';
        imgWrap.appendChild(multiImgIndicator);
      }
      
      card.appendChild(imgWrap);

      // --- TITLE ---
      const h3 = document.createElement('h3'); 
      h3.textContent = title; 
      card.appendChild(h3);

      // --- PRICE & RATING ROW ---
      const row = document.createElement('div'); 
      row.style.display = 'flex'; 
      row.style.justifyContent = 'space-between'; 
      row.style.alignItems = 'center';
      
      // Price
      const priceWrap = document.createElement('div');
      priceWrap.className = 'price-wrap';

      const priceVal = Number(price);
      const mrpVal = Number(data.mrp || priceVal);

      if (mrpVal > priceVal) {
        const oldPrice = document.createElement('span');
        oldPrice.className = 'price-old';
        oldPrice.textContent = `â‚¹${mrpVal}`;
        oldPrice.title = "Original MRP"; // 5ï¸âƒ£ LIVE CONTEXT HINT
        priceWrap.appendChild(oldPrice);
      }

      const newPrice = document.createElement('span');
      newPrice.className = 'price-new';
      newPrice.textContent = `â‚¹${priceVal}`;
      newPrice.title = "Inclusive of all taxes"; // 5ï¸âƒ£ LIVE CONTEXT HINT
      priceWrap.appendChild(newPrice);

      // Discount Badge
      if (mrpVal > priceVal) {
        const discount = Math.round(((mrpVal - priceVal) / mrpVal) * 100);
        if (discount > 0) {
          const badge = document.createElement('span');
          badge.className = 'discount-badge';
          badge.style.boxShadow = '0 2px 10px rgba(61, 220, 151, 0.2)';
          badge.textContent = `${discount}% OFF`;
          priceWrap.appendChild(badge);
        }
      }
      row.appendChild(priceWrap);

      // Rating
      const ratingWrap = document.createElement('div'); 
      ratingWrap.style.display='flex'; 
      ratingWrap.style.alignItems='center';
      
      const rEl = document.createElement('div'); 
      rEl.className = 'product-rating small'; 
      rEl.dataset.pid = id; 
      rEl.textContent = avgDisplay;
      ratingWrap.appendChild(rEl);
      
      row.appendChild(ratingWrap);
      card.appendChild(row);

      // --- DETAILS ---
      const detailsContainer = document.createElement('div');
      detailsContainer.className = 'card-details-grid';

      // Simplified card view: Only show Material if present, hide others to reduce clutter
      if(data.material) {
        const matEl = document.createElement('div');
        matEl.innerHTML = `<span style="color:var(--text-muted)">${data.material}</span>`;
        detailsContainer.appendChild(matEl);
      }
      
      // Availability
      const stockStatusText = (stock > 0) ? 'In Stock' : 'Sold Out';
      const stockColor = (stock > 0) ? 'var(--success)' : 'var(--danger)';
      const stockEl = document.createElement('div');
      stockEl.innerHTML = `<span style="color:${stockColor}; font-weight:600; font-size:12px;">${stockStatusText}</span>`;
      if(stock > 0 && stock < 5) stockEl.title = "Hurry, only a few left!"; // 5ï¸âƒ£ LIVE CONTEXT HINT
      detailsContainer.appendChild(stockEl);

      // --- COLOR SWATCHES ---
      if(data.colors && Array.isArray(data.colors) && data.colors.length > 0) {
        const swatchContainer = document.createElement('div');
        swatchContainer.className = 'card-swatches';
        data.colors.slice(0, 5).forEach(c => {
          const s = document.createElement('div');
          s.className = 'card-swatch';
          s.style.backgroundColor = FILTERS_CONFIG.colors[c.toLowerCase()] || '#ccc';
          s.title = c;
          swatchContainer.appendChild(s);
        });
        if(data.colors.length > 5) {
          const more = document.createElement('span');
          more.style.fontSize = '10px'; more.style.color = 'var(--text-muted)';
          more.textContent = `+${data.colors.length - 5}`;
          swatchContainer.appendChild(more);
        }
        detailsContainer.appendChild(swatchContainer);
      }

      card.appendChild(detailsContainer);

      // --- ORDER BUTTON ---
      const orderWrap = document.createElement('div'); 
      orderWrap.className = 'product-card-footer'; 
      orderWrap.style.display = 'flex'; orderWrap.style.gap = '8px';
      
      const orderBtn = document.createElement('button'); 
      orderBtn.className='orderBtn btn'; 
      orderBtn.type='button'; 
      orderBtn.style.flex = '1';
      orderBtn.textContent='Buy Now'; // Language cleanup
      
      // Out of stock logic
      if (stock <= 0) {
        card.classList.add('out-of-stock');
        orderBtn.disabled = true;
        orderBtn.textContent = 'Out of Stock';
      }
      // Attach data for event delegation
      orderBtn.dataset.product = title; orderBtn.dataset.price = price; orderBtn.dataset.image = primaryImage;
      
      orderWrap.appendChild(orderBtn);

      // Add to Cart Button (Icon)
      const cartBtn = document.createElement('button');
      cartBtn.className = 'addToCartBtn btn-ghost';
      cartBtn.innerHTML = '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg>';
      cartBtn.title = "Add to Cart";
      cartBtn.dataset.pid = id; cartBtn.dataset.product = title; cartBtn.dataset.price = price; cartBtn.dataset.image = primaryImage;
      if (stock <= 0) cartBtn.disabled = true;
      orderWrap.appendChild(cartBtn);

      // Wishlist Button (Moved to footer)
      const wishBtn = document.createElement('button');
      wishBtn.className = 'wishlist-btn wishlist-footer-btn btn-ghost';
      wishBtn.innerHTML = '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>';
      wishBtn.title = "Add to Wishlist";
      if (wishlistMap.has(id)) wishBtn.classList.add('active');
      
      wishBtn.addEventListener('click', (e) => { 
        e.stopPropagation(); 
        toggleWishlist({ ...data, id: id });
      });
      orderWrap.appendChild(wishBtn);

      card.appendChild(orderWrap);
      
      return card;
    }

    function renderProducts(productsToRender) {
      productGrid.innerHTML = '';

      if (productsToRender.length === 0) {
        const fallback = document.createElement('div');
        fallback.className = 'empty-state';
        fallback.innerHTML = `
          <div class="empty-state-content">
            <svg class="empty-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
            <strong style="color:#eaf6ff; display:block; margin-bottom:8px">No products found</strong>
            <div class="small">Try adjusting your search or filters to find what you're looking for.</div>
          </div>`;
        productGrid.appendChild(fallback);
        return;
      }

      const fragment = document.createDocumentFragment();
      productsToRender.forEach((productData, index) => {
        // We need a mock docSnap structure for renderProductCard
        const mockDocSnap = {
          id: productData.id,
          data: () => productData
        };
        const card = renderProductCard(mockDocSnap, index);
        fragment.appendChild(card);
      });
      productGrid.appendChild(fragment);
    }

    let productsUnsub = null;
    try{
      productsUnsub = onSnapshot(productsColRef, snap=>{
        allProducts = []; // Clear and repopulate the master list
        if(snap.empty){
          productGrid.innerHTML = `<div class="empty-state">
            <div class="empty-state-content">
              <svg class="empty-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><path d="M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5z"/><line x1="16" y1="8" x2="2" y2="22"/><line x1="17.5" y1="15" x2="9" y2="15"/></svg>
              <strong style="color:#eaf6ff; display:block; margin-bottom:8px">No products yet</strong>
              <div class="small">As admin, open Admin â†’ Add Product to upload items.</div>
              <div style="margin-top:16px"><button id="openAdminFromEmptyInner" class="btn-ghost">Open Admin</button></div>
            </div>
          </div>`;
          document.getElementById('openAdminFromEmptyInner')?.addEventListener('click', ()=>{ 
            if(!auth.currentUser){ openModal(loginModal); showLoginError('Sign in as admin to add products'); return; } 
            if(auth.currentUser.uid !== ADMIN_UID){ alert('You are not admin'); return; } 
            openModal(adminModal); 
          });
          return;
        }

        snap.forEach(d => {
          const data = d.data();
          // Optimization: Pre-calculate search string
          const searchStr = [
            data.title || '',
            data.tag || '',
            data.material || ''
          ].join(' ').toLowerCase();
          allProducts.push({ id: d.id, ...data, _searchStr: searchStr });
        });

        // âœ… DEEP LINKING: Check for product in URL
        const urlParams = new URLSearchParams(window.location.search);
        const productIdFromUrl = urlParams.get('product');
        if (productIdFromUrl) {
          // Use a timeout to ensure the rest of the UI is ready
          setTimeout(() => {
            openProductDetail(productIdFromUrl);
            // Clean up the URL to prevent re-triggering on refresh
            history.replaceState(null, '', window.location.pathname);
          }, 100);
        }

        // Initial render with all products
        applyFiltersAndRender();

        // Update product counts in filters
        updateColorFilterCounts();

        // Re-initialize all dynamic filters based on the full product list
        initializeDynamicFilters();

      }, err => { console.error('products snapshot error', err); });
    }catch(e){ console.warn('products onSnapshot not available', e); }

    // Delegate Add to Cart
    productGrid.addEventListener('click', ev => {
      const btn = ev.target.closest('.addToCartBtn');
      if(!btn) return;
      // Pass the event to get the button for feedback
      addToCart({
        pid: btn.dataset.pid,
        product: btn.dataset.product,
        price: btn.dataset.price,
        image: btn.dataset.image
      }, ev);
      // 1ï¸âƒ£ MICRO-FEEDBACK
      const originalContent = btn.innerHTML;
      btn.disabled = true;
      btn.innerHTML = 'âœ“';
      setTimeout(() => { btn.innerHTML = originalContent; btn.disabled = false; }, 1500);
    });

    // delegate order button via productGrid click
productGrid.addEventListener('click', ev=>{
  const btn = ev.target.closest('.orderBtn');
  if(!btn) return;

    const pid = btn.closest('.card')?.dataset.pid;
    if (!pid) return;
    const product = allProducts.find(p => p.id === pid);
    if (!product) {
        alert('Could not find product details. Please try again.');
        return;
    }
    createPendingOrder(product, 1);
});


    // Load user orders (persistent) and allow delete + view
    // Moved to yourorders.html as a separate page


    // ---- Admin UI: persist product to Firestore (must be guarded by rules) ----
    adminBtn && adminBtn.addEventListener('click', ()=>{
      if(!auth.currentUser){ alert('Sign in as admin'); return; }
      if(auth.currentUser.uid !== ADMIN_UID){ alert('You are not admin'); return; }
      loadAdminProductsList();
      openModal(adminModal);
    });
    
    // Handle Cancel Edit button
    $('adminCancelEdit')?.addEventListener('click', () => {
      currentEditingId = null;
      $('adminFormTitle').innerText = 'Add Product';
      $('adminSave').innerText = 'Add Product';
      $('adminCancelEdit').style.display = 'none';
      // Reset form fields
      $('admin_pTitle').value = '';
      $('admin_pPrice').value = '';
      $('admin_pMrp').value = '';
      $('admin_pTag').value = '';
      $('admin_pColors').value = '';
      $('admin_pMaterial').value = '';
      $('admin_pStyle').value = '';
      $('admin_pDesign').value = '';
      $('admin_pBlouse').value = '';
      $('admin_pStock').value = '';
      const imageUrlsContainer = $('imageUrlsContainer');
      imageUrlsContainer.innerHTML = '<input class="imageUrlInput" placeholder="Image URL 1" style="margin-bottom:8px">';
      imageUrlsContainer.querySelector('.imageUrlInput').addEventListener('input', updatePreview); // Re-attach listener
      $('admin_pPreview').style.display = 'none';
      $('admin_pTitle').focus();
    });

    // Load and render products list for admin
    async function loadAdminProductsList(){
      const listContainer = $('adminProductsList');
      if(!listContainer) return;
      listContainer.innerHTML = '<div style="text-align:center;padding:20px;"><div class="spinner"></div></div>';
      
      try{
        const snap = await getDocs(productsColRef);
        if(snap.empty){
          listContainer.innerHTML = '<div class="small" style="padding:12px;text-align:center;color:var(--muted)">No products to remove</div>';
          return;
        }
        listContainer.innerHTML = '';
        snap.forEach(docSnap=>{
          const id = docSnap.id;
          const data = docSnap.data() || {};
          const title = data.title || 'Untitled';
          const price = data.price || '0';
          
          // âœ… FIX: Normalize image source (Array vs String vs Placeholder)
          const imgSrc = (data.images && data.images[0]) || data.img || 'https://images.unsplash.com/photo-1520975918016-4d0b5b0b2f3d?q=80&w=1200&auto=format&fit=crop&ixlib=rb-4.0.3&s=placeholder';
          
          const row = document.createElement('div');
          row.className = 'admin-product-row';
          row.innerHTML = `
            <div class="admin-product-img">
              <img src="${escapeHtml(imgSrc)}" alt="${escapeHtml(title)}">
            </div>
            <div style="flex:1">
              <strong style="color:#eaf6ff">${escapeHtml(title)}</strong>
              <div class="small" style="color:var(--muted)">â‚¹${escapeHtml(price)}</div>
            </div>
            <div style="display:flex; gap:8px;">
              <button class="editProductBtn btn-ghost" data-id="${id}" type="button">Edit</button>
              <button class="deleteProductBtn btn" data-id="${id}" style="background:linear-gradient(90deg,#ff3b3b,#ff5252);white-space:nowrap" type="button">Delete</button>
            </div>
          `;
          listContainer.appendChild(row);
        });
        
        // Attach edit handlers
        listContainer.querySelectorAll('.editProductBtn').forEach(btn => {
          btn.addEventListener('click', async (ev) => {
            const id = ev.currentTarget.getAttribute('data-id');
            if (!id) return;
            try {
              const docRef = doc(db, 'products', id);
              const docSnap = await fsMod.getDoc(docRef);
              if (docSnap.exists()) {
                populateAdminFormForEdit(id, docSnap.data());
              }
            } catch (err) { console.error("Failed to fetch product for edit:", err); alert("Could not load product data."); }
          });
        });

        
        // Attach delete handlers
        listContainer.querySelectorAll('.deleteProductBtn').forEach(btn=>{
          btn.addEventListener('click', async (ev)=>{
            const id = ev.currentTarget.getAttribute('data-id');
            if(!id) return;
            const ok = confirm('Are you sure you want to delete this product? This cannot be undone.');
            if(!ok) return;
            try{
              await deleteDoc(doc(db, 'products', id));

              toast('Product deleted');
              await loadAdminProductsList();
            }catch(err){
              console.error('delete product failed', err);
              alert('Failed to delete product. See console.');
            }
          });
        });
      }catch(err){
        console.error('load admin products failed', err);
        listContainer.innerHTML = '<div class="small" style="padding:12px;color:#ffb4b4">Failed to load products</div>';
      }
    }

    function populateAdminFormForEdit(id, data) {
      currentEditingId = id;
      $('admin_pTitle').value = data.title || '';
      $('admin_pPrice').value = data.price || '';
      $('admin_pMrp').value = data.mrp || '';
      $('admin_pTag').value = data.tag || '';
      $('admin_pColors').value = (data.colors || []).join(', ');
      $('admin_pMaterial').value = data.material || '';
      $('admin_pStyle').value = data.style || '';
      $('admin_pDesign').value = data.design || '';
      $('admin_pBlouse').value = data.blouse || '';
      $('admin_pStock').value = data.stock || '';

      const imageUrlsContainer = $('imageUrlsContainer');
      imageUrlsContainer.innerHTML = ''; // Clear existing inputs
      
      // âœ… FIX: Safely extract images for edit form
      const images = (data.images && Array.isArray(data.images) && data.images.length > 0) ? data.images : (data.img ? [data.img] : []);
      
      if (images.length > 0) {
        images.forEach(url => {
          const newInput = document.createElement('input');
          newInput.className = 'imageUrlInput';
          newInput.value = url;
          newInput.addEventListener('input', updatePreview);
          newInput.style.marginBottom = '8px';
          imageUrlsContainer.appendChild(newInput);
        });
      }

      $('adminFormTitle').innerText = 'Edit Product';
      $('adminSave').innerText = 'Save Changes';
      $('adminCancelEdit').style.display = 'inline-block';
      window.scrollTo(0, 0);
      updatePreview();
    }

    // Attach listener to the initial image URL input
    const initialImageUrlInput = document.querySelector('#imageUrlsContainer .imageUrlInput');
    if (initialImageUrlInput) {
      initialImageUrlInput.addEventListener('input', updatePreview);
    }
    // Logic for adding multiple image URLs
    const addImageUrlBtn = $('addImageUrl');
    if (addImageUrlBtn) {
      addImageUrlBtn.addEventListener('click', () => {
        const imageUrlsContainer = $('imageUrlsContainer');
        const inputCount = imageUrlsContainer.querySelectorAll('.imageUrlInput').length;
        const newInput = document.createElement('input');
        newInput.addEventListener('input', updatePreview);
        newInput.type = 'text';
        newInput.className = 'imageUrlInput';
        newInput.placeholder = `Image URL ${inputCount + 1}`;
        newInput.style.marginBottom = '8px';
        imageUrlsContainer.appendChild(newInput);
      });
    }

    function isValidImageUrl(url) {
      return /^https?:\/\/.+\.(jpg|jpeg|png|webp|gif)(\?.*)?$/i.test(url);
    }

    function updatePreview() {
      const inputs = document.querySelectorAll('#imageUrlsContainer .imageUrlInput');
      const previewImage = $('admin_pPreview');
      let validUrl = null;

      inputs.forEach(input => {
        const url = input.value.trim();
        const isValid = isValidImageUrl(url);
        input.classList.toggle('valid', isValid);
        input.classList.toggle('invalid', url.length > 0 && !isValid);
        if (isValid && !validUrl) validUrl = url;
      });

      if (!validUrl) {
        previewImage.style.display = 'none';
        previewImage.src = '';
        return;
      }

      // Preload to check if it actually loads
      const img = new Image();
      img.onload = () => {
        previewImage.src = validUrl;
        previewImage.style.display = 'block';
      };
      img.onerror = () => { previewImage.style.display = 'none'; };
      img.src = validUrl;
    }

    $('adminSave').addEventListener('click', async ()=>{
      const title = $('admin_pTitle').value.trim();
      const price = Number($('admin_pPrice').value.trim());
      const tag = $('admin_pTag').value.trim();
      const mrp = Number($('admin_pMrp').value.trim()) || price;
      const colors = $('admin_pColors').value.trim().toLowerCase().split(',')
        .map(c => c.trim())
        .filter(c => c);
      const material = $('admin_pMaterial').value.trim();
      const pStyle = $('admin_pStyle').value.trim();
      const design = $('admin_pDesign').value.trim();
      const blouse = $('admin_pBlouse').value.trim();
      const stock = Number($('admin_pStock').value.trim());
      const errEl = $('adminError');
      if(errEl) errEl.textContent = '';

      const rawImageUrls = [...document.querySelectorAll('#imageUrlsContainer .imageUrlInput')]
        .map(input => input.value.trim())
        .filter(Boolean);

      const validImages = rawImageUrls.filter(isValidImageUrl);

      if (!title || !price) { if(errEl) errEl.textContent='Title and Price required'; return; }
      if (colors.length === 0) { if(errEl) errEl.textContent='Add at least one color'; return; }
      if (rawImageUrls.length === 0) { if(errEl) errEl.textContent='At least one image URL is required'; return; }
      if (validImages.length === 0) { if(errEl) errEl.textContent='Enter a valid image URL (.jpg, .png, .webp)'; return; }
      if (!auth.currentUser || auth.currentUser.uid !== ADMIN_UID) { if(errEl) errEl.textContent='Admin only'; return; }

      try {
        const btn = $('adminSave'); btn.disabled = true; btn.innerText = 'Saving...';

        const payload = {
          title,
          price,
          mrp,
          tag,
          img: validImages[0],
          material,
          colors,
          style: pStyle,
          design,
          blouse,
          stock,
          images: validImages,
        };

        if (currentEditingId) {
          // Update existing document
          await setDoc(doc(db, 'products', currentEditingId), payload, { merge: true });
          toast('Product updated');
        } else {
          // Add new document
          payload.createdAt = serverTimestamp();
          await addDoc(collection(db, 'products'), payload);
          toast('Product added');
        }

        // Reset fields
        $('adminCancelEdit').click(); // Use cancel logic to reset the form
        $('admin_pTitle').value = '';
        $('admin_pPrice').value = '';
        $('admin_pTag').value = '';
        $('admin_pMrp').value = '';
        $('admin_pColors').value = '';
        $('admin_pMaterial').value = '';
        $('admin_pStyle').value = '';
        $('admin_pDesign').value = '';
        $('admin_pBlouse').value = '';
        $('admin_pStock').value = '';

        const imageUrlsContainer = $('imageUrlsContainer');
        imageUrlsContainer.innerHTML = '<input class="imageUrlInput" placeholder="Image URL 1" style="margin-bottom: 8px;">';
        $('admin_pPreview').style.display = 'none';

        btn.disabled = false; btn.innerText = 'Add Product';
        await loadAdminProductsList();
      } catch (err) {
        console.error('add product failed', err);
        if(errEl) errEl.textContent = 'Failed: ' + (err.message || 'Error');
        $('adminSave').disabled = false;
        $('adminSave').innerText = 'Add Product';
      }
    });

    // ---- Generic modal close (fix for all X buttons) ----
    document.querySelectorAll('.close-x').forEach(btn=>{ btn.addEventListener('click', ()=>{ const modal = btn.closest('.modal'); closeModal(modal); }); });
    $('closeOrderDetail')?.addEventListener('click', ()=>{ closeModal(orderDetailModal); });
    $('closeProfile')?.addEventListener('click', ()=>{ closeModal(profileModal); });
    $('closeDetailBtn')?.addEventListener('click', ()=>{ closeModal(orderDetailModal); });
    $('closeWishlist')?.addEventListener('click', ()=>{ closeModal(wishlistModal); });

    let userProfileUnsub = null;
    // ---- Auth state changes: UI toggle ----
    onAuthStateChanged(auth, user=>{
      if(user){
        closeModal(loginModal);
        
        // Load Cart from Firestore
        getDoc(doc(db, 'users', user.uid)).then(snap => {
          if(snap.exists() && Array.isArray(snap.data().cart)){
            cart = snap.data().cart;
            updateCartUI();
          }
        });

        if(userBadge){ userBadge.style.display='inline-block'; userBadge.innerText = user.displayName || user.email; }
        if(signOutBtn) signOutBtn.style.display='inline-block';
        if(myOrdersBtn) myOrdersBtn.style.display='inline-block';
        if(profileBtn) profileBtn.style.display='inline-block';
        if($('wishlistBtn')) $('wishlistBtn').style.display='inline-block';
        if(loginShowBtn) loginShowBtn.style.display='none';
        if(adminBtn) adminBtn.style.display = (user.uid === ADMIN_UID) ? 'inline-block' : 'none';

        // 1ï¸âƒ£ & 2ï¸âƒ£ FIRST LOGIN & PROFILE ENFORCEMENT
        const userRef = doc(db, 'users', user.uid);
        
        if(userProfileUnsub) userProfileUnsub();
        userProfileUnsub = onSnapshot(userRef, (snap) => {
          if(!snap.exists()){
            setDoc(userRef, {
              uid: user.uid,
              name: user.displayName || '',
              email: user.email || '',
              phone: '',
              address: '',
              createdAt: serverTimestamp(),
              updatedAt: serverTimestamp()
            }).catch(err => console.error('Error creating profile:', err));
            return;
          }

          const data = snap.data();
          const name = (data.name || '').trim();
          const phone = (data.phone || '').trim();
          const address = (data.address || '').trim();
          const isValidPhone = /^[6-9]\d{9}$/.test(phone);
          const isProfileComplete = name && isValidPhone && address;

          if(!isProfileComplete){
            // â›” FORCE PROFILE
            isProfileForced = true;
            openModal(profileModal);
            
            // Lock down UI: Hide close button
            const closeBtn = $('closeProfile');
            if(closeBtn) closeBtn.style.display = 'none';
            
            const title = profileModal.querySelector('h2');
            if(title) title.innerText = 'Complete Your Profile';

            let msg = document.getElementById('profileForceMsg');
            if(!msg){
              msg = document.createElement('div');
              msg.id = 'profileForceMsg';
              msg.style.cssText = 'color:#3b2b08;background:linear-gradient(90deg,var(--gold),#f3d48c);padding:12px;border-radius:8px;margin-bottom:16px;font-weight:700;text-align:center;box-shadow:0 4px 12px rgba(0,0,0,0.2)';
              msg.innerText = 'Please complete your profile to continue using the website.';
              const box = profileModal.querySelector('.modal-box');
              if(box) box.insertBefore(msg, box.children[2]);
            }

            // Auto-fill if empty
            if(document.activeElement.id !== 'profileName') $('profileName').value = name;
            if(document.activeElement.id !== 'profilePhone') $('profilePhone').value = phone;
            if(document.activeElement.id !== 'profileAddress') $('profileAddress').value = address;
            $('profileEmail').value = data.email || user.email;

          } else {
            // âœ… PROFILE OK
            if(isProfileForced){
              isProfileForced = false;
              closeModal(profileModal);
              toast('Profile completed! Website unlocked.');
            }
            
            // Restore UI
            const closeBtn = $('closeProfile');
            if(closeBtn) closeBtn.style.display = 'block';
            
            const title = profileModal.querySelector('h2');
            if(title) title.innerText = 'My Profile';
            
            const msg = document.getElementById('profileForceMsg');
            if(msg) msg.remove();
          }
        }, (err) => {
          console.warn('Profile snapshot error:', err);
        });

        // ðŸ”„ REAL-TIME WISHLIST SYNC
        if (wishlistUnsub) wishlistUnsub();
        wishlistUnsub = onSnapshot(collection(db, 'users', user.uid, 'wishlist'), (snap) => {
          wishlistMap.clear();
          snap.forEach(doc => {
            wishlistMap.set(doc.id, doc.data());
          });
          updateHeartIcons();
          if(wishlistModal.classList.contains('show')) {
             renderWishlistContent();
          }
        }, (err) => {
          console.warn('Wishlist snapshot error:', err);
        });

      }else{
        if(userProfileUnsub) userProfileUnsub();
        isProfileForced = false;
        closeModal(loginModal);
        cart = []; updateCartUI();
        if(userBadge) userBadge.style.display='none';
        if(signOutBtn) signOutBtn.style.display='none';
        if(myOrdersBtn) myOrdersBtn.style.display='none';
        if(profileBtn) profileBtn.style.display='none';
        if($('wishlistBtn')) $('wishlistBtn').style.display='none';
        if(loginShowBtn) loginShowBtn.style.display='inline-block';
        if(adminBtn) adminBtn.style.display='none';
        if(wishlistUnsub) wishlistUnsub();
        wishlistMap.clear();
        updateHeartIcons();
      }
    });

    // 4ï¸âƒ£ & 5ï¸âƒ£ PROFILE MODAL LOGIC
    if(profileBtn){
      profileBtn.addEventListener('click', async () => {
        if(!auth.currentUser) return;
        openModal(profileModal);
        
        // Auto-fill
        const userRef = doc(db, 'users', auth.currentUser.uid);
        const snap = await getDoc(userRef);
        if(snap.exists()){
          const data = snap.data();
          $('profileName').value = data.name || '';
          $('profileEmail').value = data.email || auth.currentUser.email;
          $('profilePhone').value = data.phone || '';
          $('profileAddress').value = data.address || '';
        }
      });
    }

    // 6ï¸âƒ£ SAVE PROFILE
    $('saveProfileBtn')?.addEventListener('click', async () => {
      if(!auth.currentUser) return;
      const name = $('profileName').value.trim();
      const phone = $('profilePhone').value.trim();
      const address = $('profileAddress').value.trim();
      const errEl = $('profileError');
      if(errEl) errEl.textContent = '';
      $('profileName').classList.remove('invalid');
      $('profilePhone').classList.remove('invalid');
      $('profileAddress').classList.remove('invalid');

      // Validation
      if(!name) { if(errEl) errEl.textContent = 'Name is required'; $('profileName').classList.add('invalid'); return; }
      if(!/^[6-9]\d{9}$/.test(phone)) { if(errEl) errEl.textContent = 'Enter valid 10-digit Indian number'; $('profilePhone').classList.add('invalid'); return; }
      if(!address) { if(errEl) errEl.textContent = 'Address is required'; $('profileAddress').classList.add('invalid'); return; }

      const btn = $('saveProfileBtn');
      btn.disabled = true;
      btn.innerText = 'Saving...';

      try {
        await setDoc(doc(db, 'users', auth.currentUser.uid), {
          name, phone, address, updatedAt: serverTimestamp()
        }, { merge: true });
        
        // 1ï¸âƒ£ MICRO-FEEDBACK
        btn.innerText = 'Saved âœ“';

        // If forced, we do NOT close manually here. 
        // We rely on the onSnapshot listener to detect the valid data and unlock the UI.
        if(!isProfileForced){
            toast('Profile saved successfully');
            closeModal(profileModal);
        }
      } catch(e) {
        console.error(e);
        if(errEl) errEl.textContent = 'Failed to save profile. Try again.';
      } finally {
        setTimeout(() => {
          btn.disabled = false;
          btn.innerText = 'Save Profile';
        }, 2000);
      }
    });

    const shopNow = $('shopNow'); if(shopNow) shopNow.addEventListener('click', ()=>{ const grid=document.getElementById('productGrid'); if(grid) grid.scrollIntoView({behavior:'smooth'}); });

    // ---- FILTERING LOGIC ----
    function applyFiltersAndRender() {
      const searchTerm = searchBox.value.toLowerCase();
      
      let filteredProducts = allProducts.filter(product => {
        // 1. Search term filter
        const searchMatch = !searchTerm || (product._searchStr && product._searchStr.includes(searchTerm));
        if (!searchMatch) return false;

        // 2. Color filter
        const selectedColors = activeFilters.colors;
        if (selectedColors.size > 0) {
          const productColors = product.colors || [];
          const colorMatch = productColors.some(pc => selectedColors.has(pc));
          if (!colorMatch) return false;
        }

        // 3. Material filter (AND logic)
        if (activeFilters.material.size > 0 && !activeFilters.material.has(product.material?.toLowerCase() || '')) return false;

        // 4. Style filter (AND logic)
        if (activeFilters.style.size > 0 && !activeFilters.style.has(product.style?.toLowerCase() || '')) return false;

        // 5. Design filter (AND logic)
        if (activeFilters.design.size > 0 && !activeFilters.design.has(product.design?.toLowerCase() || '')) return false;

        // 6. Blouse filter (AND logic)
        if (activeFilters.blouse.size > 0 && !activeFilters.blouse.has(product.blouse?.toLowerCase() || '')) return false;

        // 7. Stock filter (AND logic)
        if (activeFilters.stock.size > 0) {
            const isInStock = (product.stock || 0) > 0;
            const selection = activeFilters.stock.has('in stock');
            // Show if user wants "In Stock" and it is, or user wants "Out of Stock" and it is not.
            if (selection !== isInStock) return false;
        }

        // 8. Price filter (OR logic between ranges)
        if (activeFilters.price.size > 0) {
          const pPrice = Number(product.price || 0);
          let priceMatch = false;
          // Check if price matches ANY selected range
          for (const rangeStr of activeFilters.price) {
            const [minStr, maxStr] = rangeStr.split('-');
            const min = Number(minStr);
            const max = maxStr === '+' ? Infinity : Number(maxStr);
            if (pPrice >= min && pPrice <= max) {
              priceMatch = true;
              break;
            }
          }
          if (!priceMatch) return false;
        }

        // If all filters pass, include the product
        return true;
      });

      // 7ï¸âƒ£ MINI "STATE CHANGE" ANIMATION
      const grid = document.getElementById('productGrid');
      if(grid) grid.animate([{ opacity: 0.5, transform: 'scale(0.99)' }, { opacity: 1, transform: 'scale(1)' }], { duration: 300, easing: 'ease-out' });
      
      // 8ï¸âƒ£ FILTER UX (Active Filters Summary)
      const activeBar = $('activeFiltersBar');
      if(activeBar) {
        const parts = [];
        if(activeFilters.colors.size) parts.push('Colors: ' + [...activeFilters.colors].map(c => c.charAt(0).toUpperCase() + c.slice(1)).join(', '));
        if(activeFilters.material.size) parts.push('Material: ' + [...activeFilters.material].map(c => c.charAt(0).toUpperCase() + c.slice(1)).join(', '));
        if(activeFilters.style.size) parts.push('Style: ' + [...activeFilters.style].map(c => c.charAt(0).toUpperCase() + c.slice(1)).join(', '));
        if(activeFilters.design.size) parts.push('Design: ' + [...activeFilters.design].map(c => c.charAt(0).toUpperCase() + c.slice(1)).join(', '));
        if(activeFilters.blouse.size) parts.push('Blouse: ' + [...activeFilters.blouse].map(c => c.charAt(0).toUpperCase() + c.slice(1)).join(', '));
        if(activeFilters.stock.size) parts.push('Availability: ' + [...activeFilters.stock].map(c => c.charAt(0).toUpperCase() + c.slice(1)).join(', '));
        if(activeFilters.price.size) parts.push('Price: ' + [...activeFilters.price].join(', '));
        
        activeBar.innerHTML = parts.length ? `<strong>Active Filters:</strong> ${parts.join(' â€¢ ')}` : '';
        activeBar.style.display = parts.length ? 'block' : 'none';
      }
      
      // ---- SORTING LOGIC ----
      const sortMode = sortSelect.value;
      if(sortMode === 'priceLow'){
        filteredProducts.sort((a,b) => Number(a.price) - Number(b.price));
      } else if(sortMode === 'priceHigh'){
        filteredProducts.sort((a,b) => Number(b.price) - Number(a.price));
      } else {
        // Default: Newest first (using createdAt if available, else fallback)
        filteredProducts.sort((a,b) => {
           const tA = a.createdAt ? (a.createdAt.seconds || 0) : 0;
           const tB = b.createdAt ? (b.createdAt.seconds || 0) : 0;
           return tB - tA;
        });
      }

      renderProducts(filteredProducts);
    }

    function updateColorFilterCounts() {
      const colorCounts = {};
      Object.keys(FILTERS_CONFIG.colors).forEach(c => colorCounts[c] = 0);

      allProducts.forEach(p => {
        (p.colors || []).forEach(color => {
          if (colorCounts.hasOwnProperty(color)) {
            colorCounts[color]++;
          }
        });
      });

      document.querySelectorAll('.color-filter-item').forEach(item => {
        const color = item.dataset.color;
        const countEl = item.querySelector('.color-count');
        if (countEl && colorCounts[color] > 0) {
          countEl.textContent = `(${colorCounts[color]})`;
        } else if (countEl) {
          countEl.textContent = '(0)';
        }
      });
    }

    // ---- Initialize Filters UI ----
    function initializeFilters() {
      // This function now handles ALL filter initialization and event listeners.
      const container = document.getElementById('colorFiltersContainer');
      if (container) container.innerHTML = '';
      for (const color in FILTERS_CONFIG.colors) {
        const item = document.createElement('div');
        item.className = 'color-filter-item';
        item.dataset.color = color;
        item.innerHTML = `
          <div class="color-swatch" style="background:${FILTERS_CONFIG.colors[color]}"></div>
          <span>${color.charAt(0).toUpperCase() + color.slice(1)}</span>
          <span class="color-count small filter-count"></span>
        `;
        item.addEventListener('click', () => {
          item.classList.toggle('active-filter');
          activeFilters.colors.has(color) ? activeFilters.colors.delete(color) : activeFilters.colors.add(color);
          applyFiltersAndRender();
        });
        container.appendChild(item);
      }

      // This now clears ALL filters
      $('clearFiltersBtn').addEventListener('click', () => {
        for (const key in activeFilters) {
            activeFilters[key].clear();
        }
        document.querySelectorAll('.active-filter').forEach(item => item.classList.remove('active-filter'));
        applyFiltersAndRender();
      });

      // Integrate search box with the new filtering system
      const clearBtn = $('clearSearch');
      if(searchBox){ let searchTimer = null;
        searchBox.addEventListener('input', () => {
          if(clearBtn) clearBtn.style.display = searchBox.value ? 'block' : 'none';
          clearTimeout(searchTimer);
          searchTimer = setTimeout(applyFiltersAndRender, 180); // Debounced call
        });
        if(clearBtn) {
          clearBtn.addEventListener('click', () => {
            searchBox.value = '';
            clearBtn.style.display = 'none';
            applyFiltersAndRender();
            searchBox.focus();
          });
        }
      }
    }
    initializeFilters();
    
    // Attach Sort Listener
    sortSelect.addEventListener('change', applyFiltersAndRender);

    // ---- Quick Filters Logic ----
    document.querySelectorAll('.qf-chip').forEach(chip => {
      chip.addEventListener('click', () => {
        // Visual toggle
        document.querySelectorAll('.qf-chip').forEach(c => c.classList.remove('active'));
        chip.classList.add('active');

        // Reset all filters first
        for (const key in activeFilters) activeFilters[key].clear();
        
        const type = chip.dataset.type;
        const val = chip.dataset.val;

        if (type !== 'all' && val) {
          if (type === 'price') activeFilters.price.add(val);
          else if (activeFilters[type]) activeFilters[type].add(val.toLowerCase());
        }
        applyFiltersAndRender();
      });
    });

    function initializePriceFilters() {
      const container = $('priceFilterGroup');
      if(!container) return;
      
      const ranges = [
        { label: 'Under â‚¹1000', val: '0-1000' },
        { label: 'â‚¹1000 - â‚¹2000', val: '1000-2000' },
        { label: 'â‚¹2000 - â‚¹4000', val: '2000-4000' },
        { label: 'Above â‚¹4000', val: '4000-+' }
      ];

      let html = `<h4 style="margin: 0 0 10px 0; font-size: 14px;">By Price</h4><div class="color-filter-grid">`;
      ranges.forEach(r => {
        const isActive = activeFilters.price.has(r.val) ? 'active-filter' : '';
        html += `<div class="filter-item ${isActive}" data-filter-group="price" data-filter-value="${r.val}">${r.label}</div>`;
      });
      html += `</div>`;
      container.innerHTML = html;
    }

    function initializeDynamicFilters() {
        const fieldsToFilter = {
            material: { label: 'By Material', container: 'materialFilterGroup' },
            style: { label: 'By Style', container: 'styleFilterGroup' },
            design: { label: 'By Design', container: 'designFilterGroup' },
        };

        // --- Generate dynamic filters from product data (Material, Style, Design) ---
        for (const field in fieldsToFilter) {
            const uniqueValues = [...new Set(allProducts.map(p => p[field]?.trim().toLowerCase()).filter(Boolean))];
            uniqueValues.sort();
            const config = fieldsToFilter[field];
            const container = $(config.container);
            if (!container) continue;

            let html = `<h4 style="margin: 0 0 10px 0; font-size: 14px;">${config.label}</h4><div class="color-filter-grid">`;
            uniqueValues.forEach(value => {
                const count = allProducts.filter(p => p[field]?.trim().toLowerCase() === value).length;
                const isActive = activeFilters[field].has(value) ? 'active-filter' : '';
                html += `<div class="filter-item ${isActive}" data-filter-group="${field}" data-filter-value="${value}">
                    ${value.charAt(0).toUpperCase() + value.slice(1)} <span class="small filter-count">(${count})</span>
                </div>`;
            });
            html += `</div>`;
            container.innerHTML = html;
        }

        // --- Generate static filters (Availability) ---
        const availabilityContainer = $('availabilityFilterGroup');
        if (availabilityContainer) {
            const inStockActive = activeFilters.stock.has('in stock') ? 'active-filter' : '';
            const outStockActive = activeFilters.stock.has('out of stock') ? 'active-filter' : '';
            availabilityContainer.innerHTML = `<h4 style="margin: 0 0 10px 0; font-size: 14px;">By Availability</h4><div class="color-filter-grid">
                <div class="filter-item ${inStockActive}" data-filter-group="stock" data-filter-value="in stock">In Stock</div>
                <div class="filter-item ${outStockActive}" data-filter-group="stock" data-filter-value="out of stock">Out of Stock</div>
            </div>`;
        }

        initializePriceFilters(); // Initialize price filters along with dynamic ones

        // --- Attach a single, delegated event listener for all new filters ---
        const filterGroupsContainer = document.getElementById('filterGroupsContainer');
        if (filterGroupsContainer && !filterGroupsContainer._bound) {
            filterGroupsContainer._bound = true; // Prevent multiple bindings
            filterGroupsContainer.addEventListener('click', (e) => {
                const item = e.target.closest('.filter-item');
                if (!item) return;
                const group = item.dataset.filterGroup;
                const value = item.dataset.filterValue;
                item.classList.toggle('active-filter');
                activeFilters[group].has(value) ? activeFilters[group].delete(value) : activeFilters[group].add(value);
                applyFiltersAndRender();
            });
        }
    }

    // initial UI ready
    document.getElementById('openAdminFromEmpty')?.addEventListener('click', ()=>{
      if(!auth.currentUser){ openModal(loginModal); showLoginError('Sign in as admin to add products'); return; }
      if(auth.currentUser.uid !== ADMIN_UID){ alert('You are not admin'); return; }
      openModal(adminModal);
    });

    // ---- Back to Top Logic ----
    const backToTopBtn = $('backToTop');
    if(backToTopBtn){
      window.addEventListener('scroll', () => {
        backToTopBtn.classList.toggle('show', window.scrollY > 300);
      });
      backToTopBtn.addEventListener('click', () => {
        window.scrollTo({ top: 0, behavior: 'smooth' });
      });
    }

    // ---- FAQ Logic ----
    document.querySelectorAll('.faq-question').forEach(btn => {
      btn.addEventListener('click', () => {
        btn.parentElement.classList.toggle('active');
      });
    });

    // Initialize reveal on static elements
    document.querySelectorAll('.hero-card, .trust-section, .filter-section, .section-title, .collections-section, .stats-section, .testimonials-section, .faq-section').forEach(el => {
      el.classList.add('reveal');
      revealObserver.observe(el);
    });

    console.log('Hamsa Sarees SPA ready â€” fixed');
  }catch(err){
    console.error('Init error', err);
    alert('Initialization failed â€” check console.');
  }
})();

</script>

  <!-- Image zoom modal (fixed) -->
  <div class="modal" id="zoomModal" aria-hidden="true">
    <button class="close-x" id="closeZoom" title="Close">âœ•</button>
    <div class="modal-box"><img id="zoomImg" src="" alt="Zoomed image"></div>
  </div>


  <!-- Product Detail Modal -->
<div class="modal" id="productDetailModal" aria-hidden="true">
  <div class="modal-box product-detail-box">
    <button class="close-x" id="closeProductDetail">âœ•</button>

    <div class="pd-layout">
      <!-- Images -->
      <div class="pd-images">
        <img id="pdMainImg" class="pd-main-img" src="" alt="Main product image">
        <div id="pdThumbs" class="pd-thumbs"></div>
      </div>

      <!-- Info -->
      <div class="pd-info">
        <h2 id="pdTitle"></h2>
        <div id="pdPrice" class="pd-price"></div>

        <!-- Container for additional product details -->
        <div id="pdDetails" style="margin: 16px 0; font-size: 14px; color: var(--text-muted); display: grid; gap: 8px;"></div>

        <!-- Quantity Selector -->
        <div id="pdQuantitySection" style="margin: 16px 0; display: none; align-items: center; gap: 12px;">
           <span style="font-weight:600; font-size:14px;">Quantity:</span>
           <div style="display:flex; align-items:center; background:rgba(255,255,255,0.03); border:1px solid var(--border); border-radius:8px;">
             <button id="qtyMinus" style="padding:8px 12px; background:none; border:none; color:var(--text-main); cursor:pointer; font-size:16px;">âˆ’</button>
             <input id="qtyInput" type="number" value="1" min="1" style="width:40px; text-align:center; border:none; background:transparent; color:var(--text-main); font-weight:700; -moz-appearance:textfield; appearance:textfield;">
             <button id="qtyPlus" style="padding:8px 12px; background:none; border:none; color:var(--text-main); cursor:pointer; font-size:16px;">+</button>
           </div>
           <span id="qtyStockMsg" class="small" style="color:var(--danger); display:none;"></span>
        </div>

        <!-- 5ï¸âƒ£ SAFE ZONES -->
        <div style="margin-top: 24px; display: flex; align-items: center; gap: 12px;">
          <button id="pdOrderBtn" class="btn" style="flex-grow: 1;">Buy Now</button>
          <button id="pdCartBtn" class="btn-ghost">Add to Cart</button>
        </div>

        <hr style="margin: 20px 0; border-color: var(--border);">

        <!-- User Reviews -->
        <h3>User Reviews</h3>
        <div id="pdRating" class="pd-rating small" style="margin-bottom: 10px;"></div>
        <div id="reviewsList" class="reviews-list small"></div>

        <hr style="margin: 20px 0; border-color: var(--border);">

        <!-- Write Review -->
        <div class="review-write">
          <h3>Write a Review</h3>
          <div class="review-stars" id="reviewStars">
            <span data-val="1">â˜…</span>
            <span data-val="2">â˜…</span>
            <span data-val="3">â˜…</span>
            <span data-val="4">â˜…</span>
            <span data-val="5">â˜…</span>
          </div>
          <br><br><textarea id="reviewText" placeholder="Share your experience (optional)"></textarea>
          <br><button id="submitReview" class="btn-ghost">Submit Review</button>
        </div>
      </div>
    </div>
    
    <div id="relatedProductsSection" style="margin-top: 24px; border-top: 1px solid var(--border); padding-top: 16px; display:none;">
      <h3 style="margin-top:0; margin-bottom:12px; font-size:18px;">You might also like</h3>
      <div id="relatedProductsGrid" style="display:grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 12px;"></div>
    </div>
  </div>
</div>

  <!-- Toast notification element -->
  <div id="toast"></div>

  <button id="backToTop" class="back-to-top" aria-label="Back to top">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 15l-6-6-6 6"/></svg>
  </button>

  <div id="floatingCartBtn" class="floating-cart" aria-label="Open Cart">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg>
    <span id="floatingCartCount" class="floating-cart-count">0</span>
  </div>

  <!-- Mobile Sticky CTA (Hidden by default) -->
  <div id="mobileStickyCta" class="mobile-sticky-cta"></div>

  <a href="https://wa.me/919994051579" target="_blank" class="whatsapp-float" aria-label="Chat on WhatsApp">
    <svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>
  </a>

  <footer>
    <div class="footer-grid">
      <div class="footer-col">
        <h4>Hamsa Sarees</h4>
        <p class="small" style="line-height:1.6; margin-bottom:20px;">Quality and tradition in every thread.</p>
        <div class="social-icons">
          <a href="https://www.youtube.com/@hamsasarees" target="_blank" class="social-icon" aria-label="YouTube"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon></svg></a>
          <a href="https://wa.me/919994051579" target="_blank" class="social-icon" aria-label="WhatsApp"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg></a>
        </div>
      </div>
      <div class="footer-col">
        <h4>Quick Links</h4>
        <a href="#">Home</a>
        <a href="#">New Arrivals</a>
        <a href="#">Best Sellers</a>
        <a href="yourorders.html">My Orders</a>
      </div>
      <div class="footer-col">
        <h4>Customer Care</h4>
        <a href="#">Contact Us</a>
        <a href="#">Shipping Policy</a>
        <a href="#">Returns & Exchanges</a>
        <a href="#">Terms of Service</a>
      </div>
    </div>
    <div class="footer-bottom">
      Â© 2025 Hamsa Sarees. All rights reserved.<br>Website Designed , Created & Published by Terminal Joint.<br>
      </div>
  </footer>

  </body>
</html>
