<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>My Orders — Hamsa Sarees</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
 
<style>
/* ================= ROOT THEME ================= */
:root{
  --bg-main:#0a0e1a;
  --bg-panel:#11172c;
  --bg-soft:#161e3d;
  --border:rgba(255,255,255,0.08);
  --gold:#e6b566;
  --gold-dark:#cfa34e;
  --text-main:#eef2ff;
  --text-muted:#9fb0d1;
  --success:#3ddc97;
  --danger:#ff6b6b;
}

/* ================= RESET ================= */
*{box-sizing:border-box}
html,body{
  margin:0;
  font-family:Inter,system-ui,Arial,sans-serif;
  background:
    radial-gradient(900px 400px at 20% -10%, rgba(230,181,102,.12), transparent 60%),
    linear-gradient(180deg,#080c18,#0a0e1a);
  color:var(--text-main);
}
.container{max-width:1200px;margin:auto;padding:20px 16px}
header{
  display:flex;
  align-items:center;
  gap:18px;
  padding:16px 18px;
  border-radius:16px;
  background:linear-gradient(180deg,#12183a,#0f152e);
  border:1px solid var(--border);
  box-shadow:0 20px 50px rgba(0,0,0,.45);
}
.brand{ display:flex; gap:12px; align-items:center; }
.logo{ width:48px; height:48px; border-radius:12px; overflow:hidden; }
.logo img { width: 100%; height: 100%; object-fit: cover; }
.title{ font-weight:800; font-size:16px; }
.small{ font-size:13px; color:var(--text-muted); }
.actions{display:flex;gap:8px;align-items:center}
.btn{
  font-family:inherit;
  background:linear-gradient(90deg,var(--gold),#f3d48c);
  color:#3b2b08;
  border:none;
  padding:10px 18px;
  border-radius:14px;
  font-weight:800;
  cursor:pointer;
  box-shadow:0 10px 30px rgba(230,181,102,.35);
  text-decoration: none;
}
.btn-ghost{
  font-family:inherit;
  background:#0f1738;
  border:1px solid var(--border);
  color:var(--text-main);
  padding:9px 16px;
  border-radius:14px;
  cursor:pointer;
  text-decoration: none;
}
.order-card{
  background:linear-gradient(180deg,#18245a,#111a3d);
  border:1px solid var(--border);
  border-radius:18px;
  padding:16px;
  margin-bottom:12px;
  display:flex;
  justify-content:space-between;
  gap:16px;
  align-items: center;
}
.order-info strong{display:block;font-size:16px;margin-bottom:6px}
img{border-radius:10px}
.modal{
  position:fixed;inset:0;display:none;
  background:rgba(5,8,15,.9);
  align-items:center;justify-content:center
}
.modal.show{display:flex}
.modal-box{
  background:linear-gradient(180deg,#162051,#0f1533);
  border:1px solid var(--border);
  border-radius:20px;
  padding:24px;
  max-width:700px;
  width:100%;
  box-shadow:0 40px 120px rgba(0,0,0,.7);
}
</style>
</head>

<body>
<div class="container">
  <header>
    <div class="brand">
      <div class="logo" aria-hidden="true"><img src="hamsasareeslogo.jpg" alt="Hamsa Sarees Logo"></div>
      <div>
        <div class="title">Hamsa Sarees</div>
        <div class="small">My Orders</div>
      </div>
    </div>
    <div style="flex:1"></div>
    <div class="actions">
      <span id="userBadge" class="small" style="display:none"></span>
      <button id="loginBtn" class="btn">Sign in</button>
      <button id="logoutBtn" class="btn-ghost" style="display:none">Sign out</button>
      <a href="index.html" class="btn-ghost">Back</a>
    </div>
  </header>

  <main>
    <div style="background:var(--bg-soft); border:1px solid var(--border); border-radius:16px; padding:16px; margin: 22px 0; display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:12px;">
      <h3 style="margin:0;">For order cancellations, please contact us on WhatsApp.</h3>
      <a href="https://whatsapp.com/channel/0029Vb7MNNbDZ4LcXUZoSz2y" target="_blank" rel="noopener noreferrer" class="btn">
        Contact Support
      </a>
    </div>
    
    <div id="ordersContainer" class="small" style="text-align:center;padding:40px; border:1px solid var(--border); border-radius:16px; margin-top:22px; background:var(--bg-panel);">
      Please sign in to view your orders
    </div>
  </main>
</div>

<!-- MODAL -->
<div class="modal" id="orderModal">
  <div class="modal-box">
    <button id="closeModal" class="btn-ghost" style="float:right; font-size:12px; padding:6px 12px;">Close</button>
    <h2>Order Details</h2>
    <pre id="orderDetails" class="small"></pre>
  </div>
</div>

<div id="toast" class="toast"></div>

<footer style="text-align:center;padding:18px;color:#9fb8d9;font-size:13px;line-height:1.6;">
  ©2025 Hamsa Sarees, unauthorized use is strictly prohibited.<br>
  Website designed, created & published by Terminal Joint.
</footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, collection, query, orderBy, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBozW19Rjc9nj0YabOIE3DlW0qVHtU5XLA",
  authDomain: "hamsasarees-24738.firebaseapp.com",
  projectId: "hamsasarees-24738"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
const provider = new GoogleAuthProvider();

const ordersContainer = document.getElementById('ordersContainer');
const userBadge = document.getElementById('userBadge');
const loginBtn = document.getElementById('loginBtn');
const logoutBtn = document.getElementById('logoutBtn');
const modal = document.getElementById('orderModal');
const orderDetails = document.getElementById('orderDetails');

async function loadOrders(){
  if(!auth.currentUser) return;

  ordersContainer.innerHTML = 'Loading...';

  const q = query(
    collection(db, `users/${auth.currentUser.uid}/orders`),
    orderBy('createdAt','desc')
  );
  const snap = await getDocs(q);

  if(snap.empty){
    ordersContainer.innerHTML = 'No orders yet';
    return;
  }

  ordersContainer.innerHTML = '';

  snap.forEach(d=>{
    const o = d.data();
    const card = document.createElement('div');
    card.className = 'order-card';
    card.innerHTML = `
      <div style="display:flex;gap:12px">
        ${o.image ? `<img src="${o.image}" width="70" height="90" style="object-fit:cover;">` : ''}
        <div class="order-info">
          <strong>${o.product}</strong>
          <div class="small">${o.name}</div>
          <div class="small">₹${o.price}</div>
        </div>
      </div>
      <div>
        <button class="btn-ghost viewBtn" data-id="${d.id}" style="font-size:12px; padding:6px 12px;">View</button>
      </div>
    `;
    ordersContainer.appendChild(card);
  });
}

ordersContainer.addEventListener('click', async e=>{
  const view = e.target.closest('.viewBtn');
  if(!view) return;

  const uid = auth.currentUser.uid;
  const id = view.dataset.id;

  const snap = await getDocs(collection(db,`users/${uid}/orders`));
  snap.forEach(d=>{
    if(d.id===id){
      const o=d.data();
      orderDetails.textContent =
`Product: ${o.product}
Price: ₹${o.price}
Name: ${o.name}
Phone: ${o.phone}
Address:
${o.address}
Payment ID:
${o.paymentId}
Status: ${o.status || 'Processing'}`;
      modal.classList.add('show');
    }
  });
});

document.getElementById('closeModal').onclick=()=>modal.classList.remove('show');
loginBtn.onclick=()=>signInWithPopup(auth,provider);
logoutBtn.onclick=()=>signOut(auth);

onAuthStateChanged(auth,user=>{
  if(user){
    userBadge.style.display='inline';
    userBadge.textContent=user.email;
    loginBtn.style.display='none';
    logoutBtn.style.display='inline';
    loadOrders();
  }else{
    ordersContainer.innerHTML='Please sign in to view your orders';
    userBadge.style.display='none';
    loginBtn.style.display='inline';
    logoutBtn.style.display='none';
  }
});
</script>

</body>
</html>
